<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
-- Copyright (c) 2020 BlueRock Security, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="../../css/coqdocjs/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="../../css/coqdocjs/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../js/coqdocjs/config.js"></script>
<script type="text/javascript" src="../../js/coqdocjs/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <!-- NOTE: These are displayed right to left on the page -->
    <span class="right">
      <a href="./indexpage.html"> Index for the theory </a>
      <a href="./toc.html"> Table of contents for the theory </a>
      <a href="../../../index.html"> Toplevel </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">bluerock.prelude.lens</h1>

<div class="code">
<span class="comment">(*<br/>
&nbsp;*&nbsp;Copyright&nbsp;(C)&nbsp;2021-2022&nbsp;BlueRock&nbsp;Security,&nbsp;Inc.<br/>
&nbsp;*&nbsp;All&nbsp;rights&nbsp;reserved.<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;This&nbsp;software&nbsp;is&nbsp;distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;BedRock&nbsp;Open-Source&nbsp;License.<br/>
&nbsp;*&nbsp;See&nbsp;the&nbsp;LICENSE-BedRock&nbsp;file&nbsp;in&nbsp;the&nbsp;repository&nbsp;root&nbsp;for&nbsp;details.<br/>
&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
This defines several useful lenses.
Some of them, however, do not satisfy all lens laws ("fake lenses").

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">elpi.apps.NES.NES</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.prelude.base.html#"><span class="id" title="library">bluerock.prelude.base</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.prelude.finite.html#"><span class="id" title="library">bluerock.prelude.finite</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.prelude.functions.html#"><span class="id" title="library">bluerock.prelude.functions</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.prelude.fun_maps.html#"><span class="id" title="library">bluerock.prelude.fun_maps</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.prelude.fin_map_dom.html#"><span class="id" title="library">bluerock.prelude.fin_map_dom</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">Lens.Lens</span>.<br/>

<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="module">LensNotations</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">lens_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="_bit" class="idref" href="#_bit"><span class="id" title="definition">_bit</span></a> (<a id="n:1" class="idref" href="#n:1"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>) : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;{| <span class="id" title="projection">view</span> := <span class="id" title="keyword">fun</span> <a id="x:2" class="idref" href="#x:2"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="definition">N.testbit</span> <a class="idref" href="bluerock.prelude.lens.html#x:2"><span class="id" title="variable">x</span></a> <a class="idref" href="bluerock.prelude.lens.html#n:1"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;&nbsp;; <span class="id" title="projection">over</span> := <span class="id" title="keyword">fun</span> (<a id="f:3" class="idref" href="#f:3"><span class="id" title="binder">f</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="x:4" class="idref" href="#x:4"><span class="id" title="binder">x</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:3"><span class="id" title="variable">f</span></a> (<span class="id" title="definition">N.testbit</span> <a class="idref" href="bluerock.prelude.lens.html#x:4"><span class="id" title="variable">x</span></a> <a class="idref" href="bluerock.prelude.lens.html#n:1"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="definition">N.setbit</span> <a class="idref" href="bluerock.prelude.lens.html#x:4"><span class="id" title="variable">x</span></a> <a class="idref" href="bluerock.prelude.lens.html#n:1"><span class="id" title="variable">n</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="definition">N.clearbit</span> <a class="idref" href="bluerock.prelude.lens.html#x:4"><span class="id" title="variable">x</span></a> <a class="idref" href="bluerock.prelude.lens.html#n:1"><span class="id" title="variable">n</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="f232366969ab1aed85b1fb147da786d6" class="idref" href="#f232366969ab1aed85b1fb147da786d6"><span class="id" title="notation">&quot;</span></a>X ~l&gt; Y" := (<span class="id" title="var">X</span> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99, <span class="id" title="var">Y</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="var">only</span> <span class="id" title="var">parsing</span>) : <span class="id" title="var">type_scope</span>.<br/>
</div>

<div class="doc">
^^ Notation to be used for "partial" lenses that do <i>not</i> respect lens laws.
Their existence is controversial, but inconvenient to avoid without supporting more optics.

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;XXX&nbsp;To&nbsp;upstream&nbsp;somewhere;&nbsp;it&nbsp;belongs&nbsp;upstream&nbsp;and/or&nbsp;in&nbsp;rocq-lens.&nbsp;*)</span><br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">Arguments</span> <span class="id" title="constructor">Build_Lens</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<a id="lens_aux_1" class="idref" href="#lens_aux_1"><span class="id" title="module"><span id="lens_aux_1.lens" class="id">NES.Begin</span></span></a> <a id="lens_aux_1" class="idref" href="#lens_aux_1"><span class="id" title="module"><span id="lens_aux_1.lens" class="id">lens</span></span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="lens_aux_1.lens.of_get_set" class="idref" href="#lens_aux_1.lens.of_get_set"><span class="id" title="definition">of_get_set</span></a> {<a id="s:5" class="idref" href="#s:5"><span class="id" title="binder">s</span></a> <a id="t:6" class="idref" href="#t:6"><span class="id" title="binder">t</span></a> <a id="a:7" class="idref" href="#a:7"><span class="id" title="binder">a</span></a> <a id="b:8" class="idref" href="#b:8"><span class="id" title="binder">b</span></a>} (<a id="get:9" class="idref" href="#get:9"><span class="id" title="binder">get</span></a> : <a class="idref" href="bluerock.prelude.lens.html#s:5"><span class="id" title="variable">s</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:7"><span class="id" title="variable">a</span></a>) (<a id="set:10" class="idref" href="#set:10"><span class="id" title="binder">set</span></a> : <a class="idref" href="bluerock.prelude.lens.html#s:5"><span class="id" title="variable">s</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:8"><span class="id" title="variable">b</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#t:6"><span class="id" title="variable">t</span></a>) : <span class="id" title="record">Lens</span> <a class="idref" href="bluerock.prelude.lens.html#s:5"><span class="id" title="variable">s</span></a> <a class="idref" href="bluerock.prelude.lens.html#t:6"><span class="id" title="variable">t</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:7"><span class="id" title="variable">a</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:8"><span class="id" title="variable">b</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">Build_Lens</span> <a class="idref" href="bluerock.prelude.lens.html#get:9"><span class="id" title="variable">get</span></a> (<span class="id" title="notation">λ</span> <span class="id" title="notation">(</span><a id="upd:11" class="idref" href="#upd:11"><span class="id" title="binder">upd</span></a> : <a class="idref" href="bluerock.prelude.lens.html#a:7"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:8"><span class="id" title="variable">b</span></a>) (<a id="x:12" class="idref" href="#x:12"><span class="id" title="binder">x</span></a> : <a class="idref" href="bluerock.prelude.lens.html#s:5"><span class="id" title="variable">s</span></a><span class="id" title="notation">),</span> <a class="idref" href="bluerock.prelude.lens.html#set:10"><span class="id" title="variable">set</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:12"><span class="id" title="variable">x</span></a> (<a class="idref" href="bluerock.prelude.lens.html#upd:11"><span class="id" title="variable">upd</span></a> (<a class="idref" href="bluerock.prelude.lens.html#get:9"><span class="id" title="variable">get</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:12"><span class="id" title="variable">x</span></a>))).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;For&nbsp;this&nbsp;to&nbsp;produce&nbsp;a&nbsp;lawful&nbsp;lens,&nbsp;it&nbsp;suffices&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">get</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">put</span></span>&nbsp;are<br/>
&nbsp;&nbsp;inverses,&nbsp;as&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="var">iso2lens</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="lens_aux_1.lens.of_get_put" class="idref" href="#lens_aux_1.lens.of_get_put"><span class="id" title="definition">of_get_put</span></a> {<a id="X:13" class="idref" href="#X:13"><span class="id" title="binder">X</span></a> <a id="Y:14" class="idref" href="#Y:14"><span class="id" title="binder">Y</span></a>} (<a id="get:15" class="idref" href="#get:15"><span class="id" title="binder">get</span></a> : <a class="idref" href="bluerock.prelude.lens.html#X:13"><span class="id" title="variable">X</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#Y:14"><span class="id" title="variable">Y</span></a>) (<a id="put:16" class="idref" href="#put:16"><span class="id" title="binder">put</span></a> : <a class="idref" href="bluerock.prelude.lens.html#Y:14"><span class="id" title="variable">Y</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#X:13"><span class="id" title="variable">X</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#X:13"><span class="id" title="variable">X</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#Y:14"><span class="id" title="variable">Y</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#lens_aux_1.lens.of_get_set"><span class="id" title="definition">of_get_set</span></a> <a class="idref" href="bluerock.prelude.lens.html#get:15"><span class="id" title="variable">get</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="bluerock.prelude.lens.html#put:16"><span class="id" title="variable">put</span></a>).<br/>
<span class="id" title="var">NES.End</span> <span class="id" title="var">lens</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="_id" class="idref" href="#_id"><span class="id" title="definition">_id</span></a> {<a id="A:17" class="idref" href="#A:17"><span class="id" title="binder">A</span></a>} : <a class="idref" href="bluerock.prelude.lens.html#A:17"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#A:17"><span class="id" title="variable">A</span></a> := <a class="idref" href="bluerock.prelude.lens.html#of_get_put"><span class="id" title="definition">lens.of_get_put</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="_fst" class="idref" href="#_fst"><span class="id" title="definition">_fst</span></a> {<a id="A:18" class="idref" href="#A:18"><span class="id" title="binder">A</span></a> <a id="B:19" class="idref" href="#B:19"><span class="id" title="binder">B</span></a>} : <a class="idref" href="bluerock.prelude.lens.html#A:18"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:19"><span class="id" title="variable">B</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#A:18"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;{| <span class="id" title="projection">view</span> := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>; <span class="id" title="projection">over</span> <a id="f:20" class="idref" href="#f:20"><span class="id" title="binder">f</span></a> <a id="p:21" class="idref" href="#p:21"><span class="id" title="binder">p</span></a> := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#f:20"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#p:21"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#p:21"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> |}.<br/>
<span class="id" title="keyword">Definition</span> <a id="_snd" class="idref" href="#_snd"><span class="id" title="definition">_snd</span></a> {<a id="A:22" class="idref" href="#A:22"><span class="id" title="binder">A</span></a> <a id="B:23" class="idref" href="#B:23"><span class="id" title="binder">B</span></a>} : <a class="idref" href="bluerock.prelude.lens.html#A:22"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:23"><span class="id" title="variable">B</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#B:23"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;{| <span class="id" title="projection">view</span> := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>; <span class="id" title="projection">over</span> <a id="f:24" class="idref" href="#f:24"><span class="id" title="binder">f</span></a> <a id="p:25" class="idref" href="#p:25"><span class="id" title="binder">p</span></a> := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#p:25"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:24"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#p:25"><span class="id" title="variable">p</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> |}.<br/>
<span class="id" title="keyword">Definition</span> <a id="_prod" class="idref" href="#_prod"><span class="id" title="definition">_prod</span></a> {<a id="A:26" class="idref" href="#A:26"><span class="id" title="binder">A</span></a> <a id="B:27" class="idref" href="#B:27"><span class="id" title="binder">B</span></a> <a id="C:28" class="idref" href="#C:28"><span class="id" title="binder">C</span></a> <a id="D:29" class="idref" href="#D:29"><span class="id" title="binder">D</span></a>} (<a id="_l1:30" class="idref" href="#_l1:30"><span class="id" title="binder">_l1</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:26"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#C:28"><span class="id" title="variable">C</span></a>) (<a id="_l2:31" class="idref" href="#_l2:31"><span class="id" title="binder">_l2</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:27"><span class="id" title="variable">B</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#D:29"><span class="id" title="variable">D</span></a>) : <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#A:26"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:27"><span class="id" title="variable">B</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#C:28"><span class="id" title="variable">C</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="bluerock.prelude.lens.html#D:29"><span class="id" title="variable">D</span></a><span class="id" title="notation">)</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="constructor">Build_Lens</span> (<span class="id" title="notation">λ</span> <span class="id" title="notation">'</span><a id="pat:40" class="idref" href="#pat:40"><span class="id" title="binder">(</span></a><a id="a:39" class="idref" href="#a:39"><span class="id" title="binder"><span id="pat:40" class="id">a</span></span></a><a id="pat:40" class="idref" href="#pat:40"><span class="id" title="binder">,</span></a> <a id="b:38" class="idref" href="#b:38"><span class="id" title="binder"><span id="pat:40" class="id">b</span></span></a><a id="pat:40" class="idref" href="#pat:40"><span class="id" title="binder">)</span></a><span class="id" title="notation">,</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#a:39"><span class="id" title="variable">a</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_l1:30"><span class="id" title="variable">_l1</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:38"><span class="id" title="variable">b</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_l2:31"><span class="id" title="variable">_l2</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">(</span></a><span class="id" title="notation">λ</span> <a id="f:32" class="idref" href="#f:32"><span class="id" title="binder">f</span></a> '<a id="pat:35" class="idref" href="#pat:35"><span class="id" title="binder">(</span></a><a id="a:34" class="idref" href="#a:34"><span class="id" title="binder"><span id="pat:35" class="id">a</span></span></a><a id="pat:35" class="idref" href="#pat:35"><span class="id" title="binder">,</span></a> <a id="b:33" class="idref" href="#b:33"><span class="id" title="binder"><span id="pat:35" class="id">b</span></span></a><a id="pat:35" class="idref" href="#pat:35"><span class="id" title="binder">)</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="c:36" class="idref" href="#c:36"><span class="id" title="binder">c</span></a> := <a class="idref" href="bluerock.prelude.lens.html#a:34"><span class="id" title="variable">a</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_l1:30"><span class="id" title="variable">_l1</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="d:37" class="idref" href="#d:37"><span class="id" title="binder">d</span></a> := <a class="idref" href="bluerock.prelude.lens.html#b:33"><span class="id" title="variable">b</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_l2:31"><span class="id" title="variable">_l2</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">c'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">d'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="bluerock.prelude.lens.html#f:32"><span class="id" title="variable">f</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#a:34"><span class="id" title="variable">a</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_l1:30"><span class="id" title="variable">_l1</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:33"><span class="id" title="variable">b</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_l2:31"><span class="id" title="variable">_l2</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#a:34"><span class="id" title="variable">a</span></a> <span class="id" title="notation">&amp;:</span> <a class="idref" href="bluerock.prelude.lens.html#_l1:30"><span class="id" title="variable">_l1</span></a> <span class="id" title="notation">.=</span> <span class="id" title="var">c'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:33"><span class="id" title="variable">b</span></a> <span class="id" title="notation">&amp;:</span> <a class="idref" href="bluerock.prelude.lens.html#_l2:31"><span class="id" title="variable">_l2</span></a> <span class="id" title="notation">.=</span> <span class="id" title="var">d'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="_const" class="idref" href="#_const"><span class="id" title="definition">_const</span></a> {<a id="A:41" class="idref" href="#A:41"><span class="id" title="binder">A</span></a> <a id="B:42" class="idref" href="#B:42"><span class="id" title="binder">B</span></a>} (<a id="b:43" class="idref" href="#b:43"><span class="id" title="binder">b</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:42"><span class="id" title="variable">B</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#A:41"><span class="id" title="variable">A</span></a> <a class="idref" href="bluerock.prelude.lens.html#f232366969ab1aed85b1fb147da786d6"><span class="id" title="notation">~</span></a><a class="idref" href="bluerock.prelude.lens.html#f232366969ab1aed85b1fb147da786d6"><span class="id" title="notation">l</span></a><a class="idref" href="bluerock.prelude.lens.html#f232366969ab1aed85b1fb147da786d6"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:42"><span class="id" title="variable">B</span></a> := <span class="id" title="constructor">Build_Lens</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Program.Basics.html#const"><span class="id" title="definition">const</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:43"><span class="id" title="variable">b</span></a>) (<span class="id" title="notation">λ</span> <span class="id" title="var">_</span> <a id="a:44" class="idref" href="#a:44"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#a:44"><span class="id" title="variable">a</span></a>).<br/>
<span class="comment">(*&nbsp;For&nbsp;this&nbsp;lens&nbsp;to&nbsp;be&nbsp;lawful,&nbsp;it&nbsp;suffices&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">get</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="tactic">set</span></span>&nbsp;are&nbsp;inverses&nbsp;on&nbsp;the<br/>
image&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">l</span>.(<span class="id" title="tactic">set</span>)</span>&nbsp;i*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="_lift" class="idref" href="#_lift"><span class="id" title="definition">_lift</span></a> {<a id="A:45" class="idref" href="#A:45"><span class="id" title="binder">A</span></a> <a id="B:46" class="idref" href="#B:46"><span class="id" title="binder">B</span></a> <a id="C:47" class="idref" href="#C:47"><span class="id" title="binder">C</span></a>} (<a id="get:48" class="idref" href="#get:48"><span class="id" title="binder">get</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:45"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:46"><span class="id" title="variable">B</span></a>) (<a id="set:49" class="idref" href="#set:49"><span class="id" title="binder">set</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:46"><span class="id" title="variable">B</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:45"><span class="id" title="variable">A</span></a>) (<a id="l:50" class="idref" href="#l:50"><span class="id" title="binder">l</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:46"><span class="id" title="variable">B</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#C:47"><span class="id" title="variable">C</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#A:45"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#C:47"><span class="id" title="variable">C</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">lens_compose</span> (<a class="idref" href="bluerock.prelude.lens.html#of_get_put"><span class="id" title="definition">lens.of_get_put</span></a> <a class="idref" href="bluerock.prelude.lens.html#get:48"><span class="id" title="variable">get</span></a> <a class="idref" href="bluerock.prelude.lens.html#set:49"><span class="id" title="variable">set</span></a>) <a class="idref" href="bluerock.prelude.lens.html#l:50"><span class="id" title="variable">l</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="_map_apply" class="idref" href="#_map_apply"><span class="id" title="definition">_map_apply</span></a> {<a id="K:51" class="idref" href="#K:51"><span class="id" title="binder">K</span></a> <a id="V:52" class="idref" href="#V:52"><span class="id" title="binder">V</span></a> <a id="M:53" class="idref" href="#M:53"><span class="id" title="binder">M</span></a>} `{<a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">Insert</span></a> <a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">K</span></a> <a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">V</span></a> <a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">M</span></a>} `{<a id="H0:55" class="idref" href="#H0:55"><span class="id" title="binder">LookupTotal</span></a> <a id="H0:55" class="idref" href="#H0:55"><span class="id" title="binder">K</span></a> <a id="H0:55" class="idref" href="#H0:55"><span class="id" title="binder">V</span></a> <a id="H0:55" class="idref" href="#H0:55"><span class="id" title="binder">M</span></a>} (<a id="k:56" class="idref" href="#k:56"><span class="id" title="binder">k</span></a> : <a class="idref" href="bluerock.prelude.lens.html#K:51"><span class="id" title="variable">K</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#M:53"><span class="id" title="variable">M</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#V:52"><span class="id" title="variable">V</span></a> :=<br/>
&nbsp;&nbsp;{| <span class="id" title="projection">view</span> <a id="f:57" class="idref" href="#f:57"><span class="id" title="binder">f</span></a> := <a class="idref" href="bluerock.prelude.lens.html#f:57"><span class="id" title="variable">f</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#5a6ec76419c81272088828e5026fff95"><span class="id" title="notation">!!!</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:56"><span class="id" title="variable">k</span></a><br/>
&nbsp;&nbsp;&nbsp;; <span class="id" title="projection">over</span> <a id="upd_f:58" class="idref" href="#upd_f:58"><span class="id" title="binder">upd_f</span></a> <a id="whole_f:59" class="idref" href="#whole_f:59"><span class="id" title="binder">whole_f</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">&lt;[</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:56"><span class="id" title="variable">k</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">:=</span></a> <a class="idref" href="bluerock.prelude.lens.html#upd_f:58"><span class="id" title="variable">upd_f</span></a> (<a class="idref" href="bluerock.prelude.lens.html#whole_f:59"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#5a6ec76419c81272088828e5026fff95"><span class="id" title="notation">!!!</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:56"><span class="id" title="variable">k</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">]&gt;</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">whole_f</span></a><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="_apply" class="idref" href="#_apply"><span class="id" title="definition">_apply</span></a> {<a id="A:60" class="idref" href="#A:60"><span class="id" title="binder">A</span></a> <a id="B:61" class="idref" href="#B:61"><span class="id" title="binder">B</span></a>} `{<a id="EqDecision0:62" class="idref" href="#EqDecision0:62"><span class="id" title="binder">EqDecision</span></a> <a id="EqDecision0:62" class="idref" href="#EqDecision0:62"><span class="id" title="binder">A</span></a>} (<a id="a:63" class="idref" href="#a:63"><span class="id" title="binder">a</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:60"><span class="id" title="variable">A</span></a>) : <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#A:60"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:61"><span class="id" title="variable">B</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#B:61"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#_map_apply"><span class="id" title="definition">_map_apply</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:63"><span class="id" title="variable">a</span></a>.<br/>

<br/>
</div>

<div class="doc">
If you can lens values <span class="inlinecode"><a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a></span> for any key <span class="inlinecode"><a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a></span> out of state <span class="inlinecode"><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a></span>,
you can also lens an entire <span class="inlinecode"><a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a></span> out of <span class="inlinecode"><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a></span>, as long as <span class="inlinecode"><a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a></span> is finite. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="_total_fun" class="idref" href="#_total_fun"><span class="id" title="definition">_total_fun</span></a> `{<a id="H:66" class="idref" href="#H:66"><span class="id" title="binder">Finite</span></a> <a id="K:64" class="idref" href="#K:64"><span class="id" title="binder"><span id="H:66" class="id">K</span></span></a>} {<a id="V:67" class="idref" href="#V:67"><span class="id" title="binder">V</span></a> <a id="S:68" class="idref" href="#S:68"><span class="id" title="binder">S</span></a>} (<a id="_key_lens:69" class="idref" href="#_key_lens:69"><span class="id" title="binder">_key_lens</span></a> : <a class="idref" href="bluerock.prelude.lens.html#K:64"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#S:68"><span class="id" title="variable">S</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#V:67"><span class="id" title="variable">V</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#S:68"><span class="id" title="variable">S</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#K:64"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#V:67"><span class="id" title="variable">V</span></a><span class="id" title="notation">)</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#of_get_set"><span class="id" title="definition">lens.of_get_set</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <span class="id" title="notation">(</span><a id="s:77" class="idref" href="#s:77"><span class="id" title="binder">s</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:68"><span class="id" title="variable">S</span></a>) (<a id="k:78" class="idref" href="#k:78"><span class="id" title="binder">k</span></a> : <a class="idref" href="bluerock.prelude.lens.html#K:64"><span class="id" title="variable">K</span></a><span class="id" title="notation">),</span> <a class="idref" href="bluerock.prelude.lens.html#s:77"><span class="id" title="variable">s</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:69"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:78"><span class="id" title="variable">k</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <span class="id" title="notation">(</span><a id="s0:70" class="idref" href="#s0:70"><span class="id" title="binder">s0</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:68"><span class="id" title="variable">S</span></a>) (<a id="kv:71" class="idref" href="#kv:71"><span class="id" title="binder">kv</span></a> : <a class="idref" href="bluerock.prelude.lens.html#K:64"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#V:67"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="set_one_key:76" class="idref" href="#set_one_key:76"><span class="id" title="binder">set_one_key</span></a> (<a id="k:72" class="idref" href="#k:72"><span class="id" title="binder"><span id="k:74" class="id">k</span></span></a> : <a class="idref" href="bluerock.prelude.lens.html#K:64"><span class="id" title="variable">K</span></a>) (<a id="s:73" class="idref" href="#s:73"><span class="id" title="binder"><span id="s:75" class="id">s</span></span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:68"><span class="id" title="variable">S</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#S:68"><span class="id" title="variable">S</span></a> := <a class="idref" href="bluerock.prelude.lens.html#s:73"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:69"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:72"><span class="id" title="variable">k</span></a> <span class="id" title="notation">.=</span> <a class="idref" href="bluerock.prelude.lens.html#kv:71"><span class="id" title="variable">kv</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:72"><span class="id" title="variable">k</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#foldr"><span class="id" title="abbreviation">foldr</span></a> <a class="idref" href="bluerock.prelude.lens.html#set_one_key:76"><span class="id" title="variable">set_one_key</span></a> <a class="idref" href="bluerock.prelude.lens.html#s0:70"><span class="id" title="variable">s0</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.finite.html#enum"><span class="id" title="method">enum</span></a> <a class="idref" href="bluerock.prelude.lens.html#K:64"><span class="id" title="variable">K</span></a>)).<br/>

<br/>
<span class="comment">(*&nbsp;Show&nbsp;that&nbsp;we&nbsp;can&nbsp;remove&nbsp;the&nbsp;abstractions&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="var">_apply</span></span>&nbsp;and&nbsp;get&nbsp;the&nbsp;old&nbsp;definition.&nbsp;*)</span><br/>
<span class="id" title="keyword">Section</span> <a id="_apply_unfold" class="idref" href="#_apply_unfold"><span class="id" title="section">_apply_unfold</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="view_apply" class="idref" href="#view_apply"><span class="id" title="lemma">view_apply</span></a> {<a id="A:79" class="idref" href="#A:79"><span class="id" title="binder">A</span></a> <a id="B:80" class="idref" href="#B:80"><span class="id" title="binder">B</span></a>} `{<a id="EqDecision0:81" class="idref" href="#EqDecision0:81"><span class="id" title="binder">EqDecision</span></a> <a id="EqDecision0:81" class="idref" href="#EqDecision0:81"><span class="id" title="binder">A</span></a>} (<a id="a:82" class="idref" href="#a:82"><span class="id" title="binder">a</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:79"><span class="id" title="variable">A</span></a>) (<a id="f:83" class="idref" href="#f:83"><span class="id" title="binder">f</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:79"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:80"><span class="id" title="variable">B</span></a>) : <span class="id" title="projection">view</span> (<a class="idref" href="bluerock.prelude.lens.html#_apply"><span class="id" title="definition">_apply</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:82"><span class="id" title="variable">a</span></a>) <a class="idref" href="bluerock.prelude.lens.html#f:83"><span class="id" title="variable">f</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:83"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:82"><span class="id" title="variable">a</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Lemma</span> <a id="over_apply_raw" class="idref" href="#over_apply_raw"><span class="id" title="lemma">over_apply_raw</span></a> {<a id="A:84" class="idref" href="#A:84"><span class="id" title="binder">A</span></a> <a id="B:85" class="idref" href="#B:85"><span class="id" title="binder">B</span></a>} `{<a id="EqDecision0:86" class="idref" href="#EqDecision0:86"><span class="id" title="binder">EqDecision</span></a> <a id="EqDecision0:86" class="idref" href="#EqDecision0:86"><span class="id" title="binder">A</span></a>} (<a id="a:87" class="idref" href="#a:87"><span class="id" title="binder">a</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:84"><span class="id" title="variable">A</span></a>) (<a id="upd_f:88" class="idref" href="#upd_f:88"><span class="id" title="binder">upd_f</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:85"><span class="id" title="variable">B</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:85"><span class="id" title="variable">B</span></a>) <a id="whole_f:89" class="idref" href="#whole_f:89"><span class="id" title="binder">whole_f</span></a> (<a id="x:90" class="idref" href="#x:90"><span class="id" title="binder">x</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:84"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="projection">over</span> (<a class="idref" href="bluerock.prelude.lens.html#_apply"><span class="id" title="definition">_apply</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:87"><span class="id" title="variable">a</span></a>) <a class="idref" href="bluerock.prelude.lens.html#upd_f:88"><span class="id" title="variable">upd_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#whole_f:89"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:90"><span class="id" title="variable">x</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<a class="idref" href="bluerock.prelude.lens.html#a:87"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:90"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="bluerock.prelude.lens.html#upd_f:88"><span class="id" title="variable">upd_f</span></a> (<a class="idref" href="bluerock.prelude.lens.html#whole_f:89"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:87"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="bluerock.prelude.lens.html#whole_f:89"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:90"><span class="id" title="variable">x</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="over_apply" class="idref" href="#over_apply"><span class="id" title="lemma">over_apply</span></a> {<a id="A:91" class="idref" href="#A:91"><span class="id" title="binder">A</span></a> <a id="B:92" class="idref" href="#B:92"><span class="id" title="binder">B</span></a>} `{<a id="EqDecision0:93" class="idref" href="#EqDecision0:93"><span class="id" title="binder">EqDecision</span></a> <a id="EqDecision0:93" class="idref" href="#EqDecision0:93"><span class="id" title="binder">A</span></a>} (<a id="a:94" class="idref" href="#a:94"><span class="id" title="binder">a</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:91"><span class="id" title="variable">A</span></a>) (<a id="upd_f:95" class="idref" href="#upd_f:95"><span class="id" title="binder">upd_f</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:92"><span class="id" title="variable">B</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:92"><span class="id" title="variable">B</span></a>) <a id="whole_f:96" class="idref" href="#whole_f:96"><span class="id" title="binder">whole_f</span></a> (<a id="x:97" class="idref" href="#x:97"><span class="id" title="binder">x</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:91"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="projection">over</span> (<a class="idref" href="bluerock.prelude.lens.html#_apply"><span class="id" title="definition">_apply</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:94"><span class="id" title="variable">a</span></a>) <a class="idref" href="bluerock.prelude.lens.html#upd_f:95"><span class="id" title="variable">upd_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#whole_f:96"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:97"><span class="id" title="variable">x</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="bluerock.prelude.lens.html#a:94"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:97"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="bluerock.prelude.lens.html#upd_f:95"><span class="id" title="variable">upd_f</span></a> (<a class="idref" href="bluerock.prelude.lens.html#whole_f:96"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:94"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="bluerock.prelude.lens.html#whole_f:96"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:97"><span class="id" title="variable">x</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="bluerock.prelude.lens.html#over_apply_raw"><span class="id" title="lemma">over_apply_raw</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#decide_bool_decide"><span class="id" title="lemma">decide_bool_decide</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.prelude.lens.html#_apply_unfold"><span class="id" title="section">_apply_unfold</span></a>.<br/>

<br/>
<span class="comment">(*<br/>
Beware:&nbsp;this&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;satisfy&nbsp;lens&nbsp;laws&nbsp;unless&nbsp;we're&nbsp;dealing&nbsp;with<br/>
"disjoint"&nbsp;lenses.&nbsp;And&nbsp;we'd&nbsp;need&nbsp;a&nbsp;PCM&nbsp;to&nbsp;formalize&nbsp;that.<br/>
Even&nbsp;monoid&nbsp;axioms&nbsp;seem&nbsp;tricky.<br/>
<br/>
But&nbsp;_my_&nbsp;concrete&nbsp;uses&nbsp;seem&nbsp;well-behaved.<br/>
*)</span><br/>
<span class="id" title="keyword">Section</span> <a id="monoid" class="idref" href="#monoid"><span class="id" title="section">monoid</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="monoid.A" class="idref" href="#monoid.A"><span class="id" title="variable">A</span></a> : <span class="id" title="keyword">Type</span>} `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Empty"><span class="id" title="class">Empty</span></a> <span class="id" title="var">M</span>} `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Union"><span class="id" title="class">Union</span></a> <a class="idref" href="bluerock.prelude.lens.html#M:99"><span class="id" title="variable">M</span></a>}.<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="lens_unit" class="idref" href="#lens_unit"><span class="id" title="instance">lens_unit</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Empty"><span class="id" title="class">Empty</span></a> (<a class="idref" href="bluerock.prelude.lens.html#monoid.A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#monoid.M"><span class="id" title="variable">M</span></a>) := <a class="idref" href="bluerock.prelude.lens.html#_const"><span class="id" title="definition">_const</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a>.<br/>

<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="lens_union" class="idref" href="#lens_union"><span class="id" title="instance">lens_union</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Union"><span class="id" title="class">Union</span></a> (<a class="idref" href="bluerock.prelude.lens.html#monoid.A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#monoid.M"><span class="id" title="variable">M</span></a>) := <span class="id" title="notation">λ</span> <a id="l1:102" class="idref" href="#l1:102"><span class="id" title="binder">l1</span></a> <a id="l2:103" class="idref" href="#l2:103"><span class="id" title="binder">l2</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">Build_Lens</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <a id="a:106" class="idref" href="#a:106"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#a:106"><span class="id" title="variable">a</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#l1:102"><span class="id" title="variable">l1</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#e8953ae2b2281f9c2fbbd0d5d6e30fd3"><span class="id" title="notation">∪</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:106"><span class="id" title="variable">a</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#l2:103"><span class="id" title="variable">l2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <a id="upd:104" class="idref" href="#upd:104"><span class="id" title="binder">upd</span></a> <a id="s:105" class="idref" href="#s:105"><span class="id" title="binder">s</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#s:105"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <a class="idref" href="bluerock.prelude.lens.html#l1:102"><span class="id" title="variable">l1</span></a> <span class="id" title="notation">%=</span> <a class="idref" href="bluerock.prelude.lens.html#upd:104"><span class="id" title="variable">upd</span></a> <span class="id" title="notation">&amp;:</span> <a class="idref" href="bluerock.prelude.lens.html#l2:103"><span class="id" title="variable">l2</span></a> <span class="id" title="notation">%=</span> <a class="idref" href="bluerock.prelude.lens.html#upd:104"><span class="id" title="variable">upd</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.prelude.axioms.funext.html#"><span class="id" title="module">bluerock.prelude.axioms.funext</span></a>.<br/>

<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="lens_left_id" class="idref" href="#lens_left_id"><span class="id" title="instance">lens_left_id</span></a> `{<a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">!</span></a><a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">LeftId</span></a> <a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">(=@{</span></a><a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">M</span></a><a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">})</span></a> <a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">∅</span></a> <a id="LeftId0:107" class="idref" href="#LeftId0:107"><span class="id" title="binder">(∪)</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#LeftId"><span class="id" title="class">LeftId</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#004e1afed1cd7c7c13e065ebaf1bfeff"><span class="id" title="notation">(=@{</span></a><a class="idref" href="bluerock.prelude.lens.html#monoid.A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#monoid.M"><span class="id" title="variable">M</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#004e1afed1cd7c7c13e065ebaf1bfeff"><span class="id" title="notation">})</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#8742fd8c92c3528c3c12cbbbb7d5e051"><span class="id" title="notation">(∪)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.prelude.lens.html#lens_unit"><span class="id" title="instance">lens_unit</span></a> /<a class="idref" href="bluerock.prelude.lens.html#lens_union"><span class="id" title="instance">lens_union</span></a> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#empty"><span class="id" title="definition">empty</span></a> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#union"><span class="id" title="definition">union</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt;[<span class="id" title="var">v</span> <span class="id" title="var">o</span>] /=; <span class="id" title="var">f_equiv</span>; <span class="id" title="var">funext</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#left_id_L"><span class="id" title="lemma">left_id_L</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="lens_right_id" class="idref" href="#lens_right_id"><span class="id" title="instance">lens_right_id</span></a> `{<a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">!</span></a><a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">RightId</span></a> <a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">(=@{</span></a><a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">M</span></a><a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">})</span></a> <a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">∅</span></a> <a id="RightId0:108" class="idref" href="#RightId0:108"><span class="id" title="binder">(∪)</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#RightId"><span class="id" title="class">RightId</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#004e1afed1cd7c7c13e065ebaf1bfeff"><span class="id" title="notation">(=@{</span></a><a class="idref" href="bluerock.prelude.lens.html#monoid.A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#monoid.M"><span class="id" title="variable">M</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#004e1afed1cd7c7c13e065ebaf1bfeff"><span class="id" title="notation">})</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#8742fd8c92c3528c3c12cbbbb7d5e051"><span class="id" title="notation">(∪)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.prelude.lens.html#lens_unit"><span class="id" title="instance">lens_unit</span></a> /<a class="idref" href="bluerock.prelude.lens.html#lens_union"><span class="id" title="instance">lens_union</span></a> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#empty"><span class="id" title="definition">empty</span></a> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#union"><span class="id" title="definition">union</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt;[<span class="id" title="var">v</span> <span class="id" title="var">o</span>] /=; <span class="id" title="var">f_equiv</span>; <span class="id" title="var">funext</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id_L"><span class="id" title="lemma">right_id_L</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="lens_assoc" class="idref" href="#lens_assoc"><span class="id" title="instance">lens_assoc</span></a> `{<a id="Assoc0:109" class="idref" href="#Assoc0:109"><span class="id" title="binder">!</span></a><a id="Assoc0:109" class="idref" href="#Assoc0:109"><span class="id" title="binder">Assoc</span></a> <a id="Assoc0:109" class="idref" href="#Assoc0:109"><span class="id" title="binder">(=@{</span></a><a id="Assoc0:109" class="idref" href="#Assoc0:109"><span class="id" title="binder">M</span></a><a id="Assoc0:109" class="idref" href="#Assoc0:109"><span class="id" title="binder">})</span></a> <a id="Assoc0:109" class="idref" href="#Assoc0:109"><span class="id" title="binder">(∪)</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#Assoc"><span class="id" title="class">Assoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#004e1afed1cd7c7c13e065ebaf1bfeff"><span class="id" title="notation">(=@{</span></a><a class="idref" href="bluerock.prelude.lens.html#monoid.A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#monoid.M"><span class="id" title="variable">M</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#004e1afed1cd7c7c13e065ebaf1bfeff"><span class="id" title="notation">})</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#8742fd8c92c3528c3c12cbbbb7d5e051"><span class="id" title="notation">(∪)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.prelude.lens.html#lens_unit"><span class="id" title="instance">lens_unit</span></a> /<a class="idref" href="bluerock.prelude.lens.html#lens_union"><span class="id" title="instance">lens_union</span></a> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#empty"><span class="id" title="definition">empty</span></a> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#union"><span class="id" title="definition">union</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt;<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> /=; <span class="id" title="var">f_equiv</span>; <span class="id" title="var">funext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#assoc_L"><span class="id" title="lemma">assoc_L</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.prelude.lens.html#monoid"><span class="id" title="section">monoid</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="iso" class="idref" href="#iso"><span class="id" title="module">iso</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="iso.t" class="idref" href="#iso.t"><span class="id" title="record">t</span></a> {<a id="A:110" class="idref" href="#A:110"><span class="id" title="binder">A</span></a> <a id="B:111" class="idref" href="#B:111"><span class="id" title="binder">B</span></a>} := <span class="id" title="var">Mk</span> { <a id="iso.f" class="idref" href="#iso.f"><span class="id" title="projection">f</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:110"><span class="id" title="variable">A</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:111"><span class="id" title="variable">B</span></a> ; <a id="iso.g" class="idref" href="#iso.g"><span class="id" title="projection">g</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:111"><span class="id" title="variable">B</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:110"><span class="id" title="variable">A</span></a> }.<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="var">Arguments</span> <a class="idref" href="bluerock.prelude.lens.html#iso.t"><span class="id" title="record">t</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>
&nbsp;&nbsp;#[<span class="id" title="var">global</span>] <span class="id" title="var">Arguments</span> <a class="idref" href="bluerock.prelude.lens.html#iso.Mk"><span class="id" title="constructor">Mk</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> : <span class="id" title="tactic">assert</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;these&nbsp;should&nbsp;be&nbsp;<span class="inlinecode"><span class="id" title="var">Cancel</span></span>&nbsp;instances.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a id="iso.lawsT" class="idref" href="#iso.lawsT"><span class="id" title="record">lawsT</span></a> {<a id="A:115" class="idref" href="#A:115"><span class="id" title="binder">A</span></a> <a id="B:116" class="idref" href="#B:116"><span class="id" title="binder">B</span></a>} (<a id="l:117" class="idref" href="#l:117"><span class="id" title="binder">l</span></a> : <a class="idref" href="bluerock.prelude.lens.html#iso.t"><span class="id" title="record">iso.t</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:115"><span class="id" title="variable">A</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:116"><span class="id" title="variable">B</span></a>) : <span class="id" title="keyword">Prop</span> := <span class="id" title="var">MkLaws</span><br/>
&nbsp;&nbsp;{ <a id="iso.f_g" class="idref" href="#iso.f_g"><span class="id" title="projection">f_g</span></a> : <span class="id" title="notation">∀</span> <a id="b:119" class="idref" href="#b:119"><span class="id" title="binder">b</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#l:117"><span class="id" title="variable">l</span></a>.(<a class="idref" href="bluerock.prelude.lens.html#iso.f"><span class="id" title="projection">f</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bluerock.prelude.lens.html#l:117"><span class="id" title="variable">l</span></a>.(<a class="idref" href="bluerock.prelude.lens.html#iso.g"><span class="id" title="projection">g</span></a>) <a class="idref" href="bluerock.prelude.lens.html#b:119"><span class="id" title="variable">b</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#b:119"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;; <a id="iso.g_f" class="idref" href="#iso.g_f"><span class="id" title="projection">g_f</span></a> : <span class="id" title="notation">∀</span> <a id="a:121" class="idref" href="#a:121"><span class="id" title="binder">a</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#l:117"><span class="id" title="variable">l</span></a>.(<a class="idref" href="bluerock.prelude.lens.html#iso.g"><span class="id" title="projection">g</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bluerock.prelude.lens.html#l:117"><span class="id" title="variable">l</span></a>.(<a class="idref" href="bluerock.prelude.lens.html#iso.f"><span class="id" title="projection">f</span></a>) <a class="idref" href="bluerock.prelude.lens.html#a:121"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#a:121"><span class="id" title="variable">a</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="iso.inv" class="idref" href="#iso.inv"><span class="id" title="definition">inv</span></a> {<a id="A:123" class="idref" href="#A:123"><span class="id" title="binder">A</span></a> <a id="B:124" class="idref" href="#B:124"><span class="id" title="binder">B</span></a>} (<a id="iso:125" class="idref" href="#iso:125"><span class="id" title="binder">iso</span></a> : <a class="idref" href="bluerock.prelude.lens.html#iso.t"><span class="id" title="record">iso.t</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:123"><span class="id" title="variable">A</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:124"><span class="id" title="variable">B</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#iso.t"><span class="id" title="record">iso.t</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:124"><span class="id" title="variable">B</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:123"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#iso.Mk"><span class="id" title="constructor">Mk</span></a> <a class="idref" href="bluerock.prelude.lens.html#iso:125"><span class="id" title="variable">iso</span></a>.(<a class="idref" href="bluerock.prelude.lens.html#iso.g"><span class="id" title="projection">g</span></a>) <a class="idref" href="bluerock.prelude.lens.html#iso:125"><span class="id" title="variable">iso</span></a>.(<a class="idref" href="bluerock.prelude.lens.html#iso.f"><span class="id" title="projection">f</span></a>).<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.prelude.lens.html#iso"><span class="id" title="module">iso</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="iso2lens" class="idref" href="#iso2lens"><span class="id" title="definition">iso2lens</span></a> {<a id="A:126" class="idref" href="#A:126"><span class="id" title="binder">A</span></a> <a id="B:127" class="idref" href="#B:127"><span class="id" title="binder">B</span></a>} (<a id="i:128" class="idref" href="#i:128"><span class="id" title="binder">i</span></a> : <a class="idref" href="bluerock.prelude.lens.html#t"><span class="id" title="record">iso.t</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:126"><span class="id" title="variable">A</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:127"><span class="id" title="variable">B</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#A:126"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#B:127"><span class="id" title="variable">B</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#of_get_put"><span class="id" title="definition">lens.of_get_put</span></a> (<a class="idref" href="bluerock.prelude.lens.html#f"><span class="id" title="projection">iso.f</span></a> <a class="idref" href="bluerock.prelude.lens.html#i:128"><span class="id" title="variable">i</span></a>) (<a class="idref" href="bluerock.prelude.lens.html#g"><span class="id" title="projection">iso.g</span></a> <a class="idref" href="bluerock.prelude.lens.html#i:128"><span class="id" title="variable">i</span></a>).<br/>

<br/>
</div>

<div class="doc">
Lens laws for monomorphic lenses <span class="inlinecode"><a class="idref" href="bluerock.prelude.elpi.derive_test.html#BitsetTest.A"><span class="id" title="constructor">A</span></a></span> <span class="inlinecode">-<span class="id" title="var">l</span>&gt;</span> <span class="inlinecode"><a class="idref" href="bluerock.prelude.elpi.derive_test.html#BitsetTest.B"><span class="id" title="constructor">B</span></a></span>.
Provisional; these are useful as a sanity checks, but no inference convenience
is provided.

<div class="paragraph"> </div>

TODO FM-1193 for a proper solution.

</div>
<div class="code">
<span class="id" title="keyword">Record</span> <a id="LensLaws'" class="idref" href="#LensLaws'"><span class="id" title="record">LensLaws'</span></a> {<a id="A:129" class="idref" href="#A:129"><span class="id" title="binder">A</span></a> <a id="B:130" class="idref" href="#B:130"><span class="id" title="binder">B</span></a>} {<a id="R:131" class="idref" href="#R:131"><span class="id" title="binder">R</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Relations.Relation_Definitions.html#relation"><span class="id" title="definition">relation</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:129"><span class="id" title="variable">A</span></a>} {<a id="S:132" class="idref" href="#S:132"><span class="id" title="binder">S</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Relations.Relation_Definitions.html#relation"><span class="id" title="definition">relation</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:130"><span class="id" title="variable">B</span></a>} {<a id="l:133" class="idref" href="#l:133"><span class="id" title="binder">l</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:129"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#B:130"><span class="id" title="variable">B</span></a>} := <span class="id" title="var">MkLensLaws</span><br/>
{ <a id="view_over" class="idref" href="#view_over"><span class="id" title="projection">view_over</span></a> <a id="upd:135" class="idref" href="#upd:135"><span class="id" title="binder">upd</span></a> <a id="x:136" class="idref" href="#x:136"><span class="id" title="binder">x</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:132"><span class="id" title="variable">S</span></a> (<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> (<span class="id" title="projection">over</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#upd:135"><span class="id" title="variable">upd</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:136"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="bluerock.prelude.lens.html#upd:135"><span class="id" title="variable">upd</span></a> (<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:136"><span class="id" title="variable">x</span></a>))<br/>
; <a id="view_set" class="idref" href="#view_set"><span class="id" title="projection">view_set</span></a> <a id="x:138" class="idref" href="#x:138"><span class="id" title="binder">x</span></a> <a id="v:139" class="idref" href="#v:139"><span class="id" title="binder">v</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:132"><span class="id" title="variable">S</span></a> (<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:139"><span class="id" title="variable">v</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:138"><span class="id" title="variable">x</span></a>)) <a class="idref" href="bluerock.prelude.lens.html#v:139"><span class="id" title="variable">v</span></a><br/>
; <a id="set_view" class="idref" href="#set_view"><span class="id" title="projection">set_view</span></a> <a id="x:141" class="idref" href="#x:141"><span class="id" title="binder">x</span></a> : <a class="idref" href="bluerock.prelude.lens.html#R:131"><span class="id" title="variable">R</span></a> (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> (<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:141"><span class="id" title="variable">x</span></a>) <a class="idref" href="bluerock.prelude.lens.html#x:141"><span class="id" title="variable">x</span></a>) <a class="idref" href="bluerock.prelude.lens.html#x:141"><span class="id" title="variable">x</span></a><br/>
; <a id="set_set" class="idref" href="#set_set"><span class="id" title="projection">set_set</span></a> <a id="x:143" class="idref" href="#x:143"><span class="id" title="binder">x</span></a> <a id="v:144" class="idref" href="#v:144"><span class="id" title="binder">v</span></a> <a id="v':145" class="idref" href="#v':145"><span class="id" title="binder">v'</span></a> : <a class="idref" href="bluerock.prelude.lens.html#R:131"><span class="id" title="variable">R</span></a> (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#v':145"><span class="id" title="variable">v'</span></a> (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:144"><span class="id" title="variable">v</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:143"><span class="id" title="variable">x</span></a>)) (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#l:133"><span class="id" title="variable">l</span></a> <a class="idref" href="bluerock.prelude.lens.html#v':145"><span class="id" title="variable">v'</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:143"><span class="id" title="variable">x</span></a>)<br/>
}.<br/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">R</span> <span class="id" title="var">S</span> <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="iso2lens_laws" class="idref" href="#iso2lens_laws"><span class="id" title="lemma">iso2lens_laws</span></a> {<a id="A:147" class="idref" href="#A:147"><span class="id" title="binder">A</span></a> <a id="B:148" class="idref" href="#B:148"><span class="id" title="binder">B</span></a>} (<a id="i:149" class="idref" href="#i:149"><span class="id" title="binder">i</span></a> : <a class="idref" href="bluerock.prelude.lens.html#t"><span class="id" title="record">iso.t</span></a> <a class="idref" href="bluerock.prelude.lens.html#A:147"><span class="id" title="variable">A</span></a> <a class="idref" href="bluerock.prelude.lens.html#B:148"><span class="id" title="variable">B</span></a>) (<a id="Hl:150" class="idref" href="#Hl:150"><span class="id" title="binder">Hl</span></a> : <a class="idref" href="bluerock.prelude.lens.html#lawsT"><span class="id" title="record">iso.lawsT</span></a> <a class="idref" href="bluerock.prelude.lens.html#i:149"><span class="id" title="variable">i</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<a class="idref" href="bluerock.prelude.lens.html#iso2lens"><span class="id" title="definition">iso2lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#i:149"><span class="id" title="variable">i</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="var">i</span> <span class="id" title="var">Hl</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">g</span> [/= <span class="id" title="var">f_g</span> <span class="id" title="var">g_f</span>]; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="_constr" class="idref" href="#_constr"><span class="id" title="section">_constr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="_constr.A1" class="idref" href="#_constr.A1"><span class="id" title="variable">A1</span></a> <a id="_constr.A2" class="idref" href="#_constr.A2"><span class="id" title="variable">A2</span></a> <a id="_constr.B" class="idref" href="#_constr.B"><span class="id" title="variable">B</span></a> : <span class="id" title="keyword">Type</span>} (<a id="_constr.constr" class="idref" href="#_constr.constr"><span class="id" title="variable">constr</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A1:151"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#A2:152"><span class="id" title="variable">A2</span></a>) (<a id="_constr.inv" class="idref" href="#_constr.inv"><span class="id" title="variable">inv</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A2:152"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="bluerock.prelude.lens.html#A1:151"><span class="id" title="variable">A1</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="_constr" class="idref" href="#_constr"><span class="id" title="definition">_constr</span></a> : <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#_constr.A2"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#_constr.B"><span class="id" title="variable">B</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#_constr.A1"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#_constr.B"><span class="id" title="variable">B</span></a><span class="id" title="notation">)</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id" title="projection">view</span> <a id="f:156" class="idref" href="#f:156"><span class="id" title="binder">f</span></a> <a id="r:157" class="idref" href="#r:157"><span class="id" title="binder">r</span></a> := <a class="idref" href="bluerock.prelude.lens.html#f:156"><span class="id" title="variable">f</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#r:157"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="projection">over</span> <a id="upd_f:158" class="idref" href="#upd_f:158"><span class="id" title="binder">upd_f</span></a> <a id="whole_f:159" class="idref" href="#whole_f:159"><span class="id" title="binder">whole_f</span></a> <a id="r:160" class="idref" href="#r:160"><span class="id" title="binder">r</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> <a class="idref" href="bluerock.prelude.lens.html#r:160"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">gr</span> =&gt; <a class="idref" href="bluerock.prelude.lens.html#upd_f:158"><span class="id" title="variable">upd_f</span></a> (<span class="id" title="notation">λ</span> <a id="r:161" class="idref" href="#r:161"><span class="id" title="binder">r</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#whole_f:159"><span class="id" title="variable">whole_f</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#r:161"><span class="id" title="variable">r</span></a>)) <span class="id" title="var">gr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="bluerock.prelude.lens.html#whole_f:159"><span class="id" title="variable">whole_f</span></a> <a class="idref" href="bluerock.prelude.lens.html#r:160"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> |}.<br/>
&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;As&nbsp;a&nbsp;test,&nbsp;prove&nbsp;lens&nbsp;laws&nbsp;from<br/>
&nbsp;&nbsp;https://hackage.haskell.org/package/lens-5.0.1/docs/Control-Lens-Lens.html<br/>
&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="constr_view_over" class="idref" href="#constr_view_over"><span class="id" title="lemma">constr_view_over</span></a> <a id="f:162" class="idref" href="#f:162"><span class="id" title="binder">f</span></a> <a id="upd:163" class="idref" href="#upd:163"><span class="id" title="binder">upd</span></a> <a id="a1:164" class="idref" href="#a1:164"><span class="id" title="binder">a1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hinv1:166" class="idref" href="#Hinv1:166"><span class="id" title="binder">Hinv1</span></a> : <span class="id" title="notation">∀</span> <a id="x:165" class="idref" href="#x:165"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:165"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:165"><span class="id" title="variable">x</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> (<span class="id" title="projection">over</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#upd:163"><span class="id" title="variable">upd</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:162"><span class="id" title="variable">f</span></a>) <a class="idref" href="bluerock.prelude.lens.html#a1:164"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#upd:163"><span class="id" title="variable">upd</span></a> (<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:162"><span class="id" title="variable">f</span></a>) <a class="idref" href="bluerock.prelude.lens.html#a1:164"><span class="id" title="variable">a1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">cbv</span>. <span class="id" title="tactic">move</span>: <span class="id" title="var">Hinv1</span> =&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">a1</span>). <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: (<a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> <span class="id" title="var">_</span>) =&gt; [<span class="id" title="var">a</span> [-&gt;]|]. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;view&nbsp;l&nbsp;(set&nbsp;l&nbsp;v&nbsp;s)&nbsp;&nbsp;≡&nbsp;v&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="constr_view_set" class="idref" href="#constr_view_set"><span class="id" title="lemma">constr_view_set</span></a> <a id="f:167" class="idref" href="#f:167"><span class="id" title="binder">f</span></a> <a id="a1:168" class="idref" href="#a1:168"><span class="id" title="binder">a1</span></a> <a id="v:169" class="idref" href="#v:169"><span class="id" title="binder">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hinv1:171" class="idref" href="#Hinv1:171"><span class="id" title="binder">Hinv1</span></a> : <span class="id" title="notation">∀</span> <a id="x:170" class="idref" href="#x:170"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:170"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:170"><span class="id" title="variable">x</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:169"><span class="id" title="variable">v</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:167"><span class="id" title="variable">f</span></a>) <a class="idref" href="bluerock.prelude.lens.html#a1:168"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:169"><span class="id" title="variable">v</span></a> <a class="idref" href="bluerock.prelude.lens.html#a1:168"><span class="id" title="variable">a1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="bluerock.prelude.lens.html#constr_view_over"><span class="id" title="lemma">constr_view_over</span></a>, <span class="id" title="var">Hinv1</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;set&nbsp;l&nbsp;(view&nbsp;l&nbsp;s)&nbsp;s&nbsp;≡&nbsp;s&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="constr_set_view" class="idref" href="#constr_set_view"><span class="id" title="lemma">constr_set_view</span></a> <a id="f:172" class="idref" href="#f:172"><span class="id" title="binder">f</span></a> <a id="a2:173" class="idref" href="#a2:173"><span class="id" title="binder">a2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hinv2:176" class="idref" href="#Hinv2:176"><span class="id" title="binder">Hinv2</span></a> : <span class="id" title="notation">∀</span> <a id="a1:174" class="idref" href="#a1:174"><span class="id" title="binder">a1</span></a> <a id="a2:175" class="idref" href="#a2:175"><span class="id" title="binder">a2</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:175"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.prelude.lens.html#a1:174"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#a1:174"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:175"><span class="id" title="variable">a2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> (<span class="id" title="projection">view</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:172"><span class="id" title="variable">f</span></a>) <a class="idref" href="bluerock.prelude.lens.html#f:172"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:173"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:172"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:173"><span class="id" title="variable">a2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">cbv</span>. <span class="id" title="tactic">case</span> <span class="id" title="var">E</span>: (<a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> <span class="id" title="var">_</span>) =&gt; [<span class="id" title="var">a1</span>|//]. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Hinv2</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;set&nbsp;l&nbsp;v'&nbsp;(set&nbsp;l&nbsp;v&nbsp;s)&nbsp;≡&nbsp;set&nbsp;l&nbsp;v'&nbsp;s&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="constr_set_set" class="idref" href="#constr_set_set"><span class="id" title="lemma">constr_set_set</span></a> <a id="f:177" class="idref" href="#f:177"><span class="id" title="binder">f</span></a> <a id="v:178" class="idref" href="#v:178"><span class="id" title="binder">v</span></a> <a id="v':179" class="idref" href="#v':179"><span class="id" title="binder">v'</span></a> <a id="a2:180" class="idref" href="#a2:180"><span class="id" title="binder">a2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#v':179"><span class="id" title="variable">v'</span></a> (<span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:178"><span class="id" title="variable">v</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:177"><span class="id" title="variable">f</span></a>) <a class="idref" href="bluerock.prelude.lens.html#a2:180"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">set</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#v':179"><span class="id" title="variable">v'</span></a> <a class="idref" href="bluerock.prelude.lens.html#f:177"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:180"><span class="id" title="variable">a2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">cbv</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">case_match</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="constr_laws" class="idref" href="#constr_laws"><span class="id" title="lemma">constr_laws</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hinv1:182" class="idref" href="#Hinv1:182"><span class="id" title="binder">Hinv1</span></a> : <span class="id" title="notation">∀</span> <a id="x:181" class="idref" href="#x:181"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:181"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.prelude.lens.html#x:181"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hinv2:185" class="idref" href="#Hinv2:185"><span class="id" title="binder">Hinv2</span></a> : <span class="id" title="notation">∀</span> <a id="a1:183" class="idref" href="#a1:183"><span class="id" title="binder">a1</span></a> <a id="a2:184" class="idref" href="#a2:184"><span class="id" title="binder">a2</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#_constr.inv"><span class="id" title="variable">inv</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:184"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.prelude.lens.html#a1:183"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#_constr.constr"><span class="id" title="variable">constr</span></a> <a class="idref" href="bluerock.prelude.lens.html#a1:183"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#a2:184"><span class="id" title="variable">a2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Classes.Morphisms.html#pointwise_relation"><span class="id" title="definition">pointwise_relation</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Classes.Morphisms.html#pointwise_relation"><span class="id" title="definition">pointwise_relation</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="definition">_constr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> * ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span>: <a class="idref" href="bluerock.prelude.lens.html#constr_view_over"><span class="id" title="lemma">constr_view_over</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span>: <a class="idref" href="bluerock.prelude.lens.html#constr_view_set"><span class="id" title="lemma">constr_view_set</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span>: <a class="idref" href="bluerock.prelude.lens.html#constr_set_view"><span class="id" title="lemma">constr_set_view</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span>: <a class="idref" href="bluerock.prelude.lens.html#constr_set_set"><span class="id" title="lemma">constr_set_set</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.prelude.lens.html#_constr"><span class="id" title="section">_constr</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="_prod_lens_laws" class="idref" href="#_prod_lens_laws"><span class="id" title="lemma">_prod_lens_laws</span></a> {<a id="A:186" class="idref" href="#A:186"><span class="id" title="binder">A</span></a> <a id="B:187" class="idref" href="#B:187"><span class="id" title="binder">B</span></a> <a id="C:188" class="idref" href="#C:188"><span class="id" title="binder">C</span></a> <a id="D:189" class="idref" href="#D:189"><span class="id" title="binder">D</span></a>} (<a id="_l1:190" class="idref" href="#_l1:190"><span class="id" title="binder">_l1</span></a> : <a class="idref" href="bluerock.prelude.lens.html#A:186"><span class="id" title="variable">A</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#C:188"><span class="id" title="variable">C</span></a>) (<a id="_l2:191" class="idref" href="#_l2:191"><span class="id" title="binder">_l2</span></a> : <a class="idref" href="bluerock.prelude.lens.html#B:187"><span class="id" title="variable">B</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#D:189"><span class="id" title="variable">D</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="bluerock.prelude.lens.html#_l1:190"><span class="id" title="variable">_l1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="bluerock.prelude.lens.html#_l2:191"><span class="id" title="variable">_l2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_prod"><span class="id" title="definition">_prod</span></a> <a class="idref" href="bluerock.prelude.lens.html#_l1:190"><span class="id" title="variable">_l1</span></a> <a class="idref" href="bluerock.prelude.lens.html#_l2:191"><span class="id" title="variable">_l2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L1</span> <span class="id" title="var">L2</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">case_match</span>; <span class="id" title="var">simplify_eq</span>/= =&gt; //.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#view_over"><span class="id" title="projection">view_over</span></a> <span class="id" title="var">L1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#view_over"><span class="id" title="projection">view_over</span></a> <span class="id" title="var">L2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#view_set"><span class="id" title="projection">view_set</span></a> <span class="id" title="var">L1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#view_set"><span class="id" title="projection">view_set</span></a> <span class="id" title="var">L2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#set_view"><span class="id" title="projection">set_view</span></a> <span class="id" title="var">L1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#set_view"><span class="id" title="projection">set_view</span></a> <span class="id" title="var">L2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#set_set"><span class="id" title="projection">set_set</span></a> <span class="id" title="var">L1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.prelude.lens.html#set_set"><span class="id" title="projection">set_set</span></a> <span class="id" title="var">L2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Notation to be used for "partial" lenses. 
</div>
<div class="code">
<span class="id" title="keyword">Notation</span> <a id="c70f0d8fc4f2dcb673fb5ca3d61121c0" class="idref" href="#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">&quot;</span></a>X -~l&gt; Y" := (<span class="id" title="var">X</span> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99, <span class="id" title="var">Y</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="var">only</span> <span class="id" title="var">parsing</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="map_from_finite" class="idref" href="#map_from_finite"><span class="id" title="section">map_from_finite</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="map_from_finite.K" class="idref" href="#map_from_finite.K"><span class="id" title="variable">K</span></a> <a id="map_from_finite.V" class="idref" href="#map_from_finite.V"><span class="id" title="variable">V</span></a> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.finite.html#Finite"><span class="id" title="class">Finite</span></a> <a class="idref" href="bluerock.prelude.lens.html#K:192"><span class="id" title="variable">K</span></a>} `{<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_map_dom.html#FinMapDom"><span class="id" title="class">FinMapDom</span></a> <a class="idref" href="bluerock.prelude.lens.html#K:192"><span class="id" title="variable">K</span></a> <span class="id" title="var">M</span> <span class="id" title="var">D</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> (<span class="id" title="var">f</span> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="fun_to_map" class="idref" href="#fun_to_map"><span class="id" title="abbreviation">fun_to_map</span></a> := (<a class="idref" href="bluerock.prelude.fun_maps.html#fun_to_map"><span class="id" title="definition">fun_to_map</span></a> (<span class="id" title="var">M</span> := <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a>)).<br/>
&nbsp;&nbsp;#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Proof</span> <span class="id" title="var">Using</span> "Type*".<br/>

<br/>
</div>

<div class="doc">
Produce a partial lens: writing a map <span class="inlinecode"><span class="id" title="var">m</span></span> will only update keys in <span class="inlinecode"><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#dom"><span class="id" title="definition">dom</span></a></span> <span class="inlinecode"><span class="id" title="var">m</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="_fun_to_map" class="idref" href="#_fun_to_map"><span class="id" title="definition">_fun_to_map</span></a> `{<a id="H15:214" class="idref" href="#H15:214"><span class="id" title="binder">Inhabited</span></a> <a id="H15:214" class="idref" href="#H15:214"><span class="id" title="binder">V</span></a>} : <a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a><a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">)</span></a> <a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">-~</span></a><a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">l</span></a><a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#of_get_set"><span class="id" title="definition">lens.of_get_set</span></a> <a class="idref" href="bluerock.prelude.lens.html#fun_to_map"><span class="id" title="abbreviation">fun_to_map</span></a> (<span class="id" title="notation">λ</span> <a id="rs:215" class="idref" href="#rs:215"><span class="id" title="binder">rs</span></a> <a id="rm:216" class="idref" href="#rm:216"><span class="id" title="binder">rm</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.fun_maps.html#map_to_fun"><span class="id" title="abbreviation">map_to_fun</span></a> (<a class="idref" href="bluerock.prelude.lens.html#rm:216"><span class="id" title="variable">rm</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#e8953ae2b2281f9c2fbbd0d5d6e30fd3"><span class="id" title="notation">∪</span></a> <a class="idref" href="bluerock.prelude.lens.html#fun_to_map"><span class="id" title="abbreviation">fun_to_map</span></a> <a class="idref" href="bluerock.prelude.lens.html#rs:215"><span class="id" title="variable">rs</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="_fun_to_map_lookup" class="idref" href="#_fun_to_map_lookup"><span class="id" title="lemma">_fun_to_map_lookup</span></a> `{<a id="H15:217" class="idref" href="#H15:217"><span class="id" title="binder">Inhabited</span></a> <a id="H15:217" class="idref" href="#H15:217"><span class="id" title="binder">V</span></a>} <a id="f:218" class="idref" href="#f:218"><span class="id" title="binder">f</span></a> <a id="rn:219" class="idref" href="#rn:219"><span class="id" title="binder">rn</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#f:218"><span class="id" title="variable">f</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_fun_to_map"><span class="id" title="definition">_fun_to_map</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:219"><span class="id" title="variable">rn</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bluerock.prelude.lens.html#f:218"><span class="id" title="variable">f</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:219"><span class="id" title="variable">rn</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="bluerock.prelude.fun_maps.html#lookup_fun_to_map"><span class="id" title="lemma">lookup_fun_to_map</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Produce a partial lens: writing a map <span class="inlinecode"><span class="id" title="var">m</span></span> will only update keys in <span class="inlinecode"><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#dom"><span class="id" title="definition">dom</span></a></span> <span class="inlinecode"><span class="id" title="var">m</span></span>,
    using <span class="inlinecode"><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>(|<span class="id" title="var">m</span>|)</span> calls to <span class="inlinecode"><span class="id" title="var">_key_lens</span></span>.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="_map_lens" class="idref" href="#_map_lens"><span class="id" title="definition">_map_lens</span></a> {<a id="S:220" class="idref" href="#S:220"><span class="id" title="binder">S</span></a>} (<a id="_key_lens:221" class="idref" href="#_key_lens:221"><span class="id" title="binder">_key_lens</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#S:220"><span class="id" title="variable">S</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#S:220"><span class="id" title="variable">S</span></a> <a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">-~</span></a><a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">l</span></a><a class="idref" href="bluerock.prelude.lens.html#c70f0d8fc4f2dcb673fb5ca3d61121c0"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#of_get_set"><span class="id" title="definition">lens.of_get_set</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <span class="id" title="notation">(</span><a id="s:231" class="idref" href="#s:231"><span class="id" title="binder">s</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:220"><span class="id" title="variable">S</span></a><span class="id" title="notation">),</span> <a class="idref" href="bluerock.prelude.lens.html#fun_to_map"><span class="id" title="abbreviation">fun_to_map</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <span class="id" title="notation">λ</span> <span class="id" title="notation">(</span><a id="k:232" class="idref" href="#k:232"><span class="id" title="binder">k</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a><span class="id" title="notation">),</span> <a class="idref" href="bluerock.prelude.lens.html#s:231"><span class="id" title="variable">s</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:221"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:232"><span class="id" title="variable">k</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <span class="id" title="notation">(</span><a id="s0:222" class="idref" href="#s0:222"><span class="id" title="binder">s0</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:220"><span class="id" title="variable">S</span></a>) (<a id="m:223" class="idref" href="#m:223"><span class="id" title="binder">m</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="set_one_key:230" class="idref" href="#set_one_key:230"><span class="id" title="binder">set_one_key</span></a> (<a id="k:224" class="idref" href="#k:224"><span class="id" title="binder"><span id="k:227" class="id">k</span></span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a>) (<a id="v:225" class="idref" href="#v:225"><span class="id" title="binder"><span id="v:228" class="id">v</span></span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) (<a id="s:226" class="idref" href="#s:226"><span class="id" title="binder"><span id="s:229" class="id">s</span></span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:220"><span class="id" title="variable">S</span></a>) : <a class="idref" href="bluerock.prelude.lens.html#S:220"><span class="id" title="variable">S</span></a> := <a class="idref" href="bluerock.prelude.lens.html#s:226"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:221"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:224"><span class="id" title="variable">k</span></a> <span class="id" title="notation">.=</span> <a class="idref" href="bluerock.prelude.lens.html#v:225"><span class="id" title="variable">v</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_maps.html#map_fold"><span class="id" title="definition">map_fold</span></a> <a class="idref" href="bluerock.prelude.lens.html#set_one_key:230"><span class="id" title="variable">set_one_key</span></a> <a class="idref" href="bluerock.prelude.lens.html#s0:222"><span class="id" title="variable">s0</span></a> <a class="idref" href="bluerock.prelude.lens.html#m:223"><span class="id" title="variable">m</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="_map_lens_lookup" class="idref" href="#_map_lens_lookup"><span class="id" title="lemma">_map_lens_lookup</span></a> {<a id="S:233" class="idref" href="#S:233"><span class="id" title="binder">S</span></a>} (<a id="s:234" class="idref" href="#s:234"><span class="id" title="binder">s</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:233"><span class="id" title="variable">S</span></a>) <a id="rn:235" class="idref" href="#rn:235"><span class="id" title="binder">rn</span></a> (<a id="_key_lens:236" class="idref" href="#_key_lens:236"><span class="id" title="binder">_key_lens</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#S:233"><span class="id" title="variable">S</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.prelude.lens.html#s:234"><span class="id" title="variable">s</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_map_lens"><span class="id" title="definition">_map_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:236"><span class="id" title="variable">_key_lens</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:235"><span class="id" title="variable">rn</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bluerock.prelude.lens.html#s:234"><span class="id" title="variable">s</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:236"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:235"><span class="id" title="variable">rn</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="bluerock.prelude.fun_maps.html#lookup_fun_to_map"><span class="id" title="lemma">lookup_fun_to_map</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="_map_lens_set_lookup_aux" class="idref" href="#_map_lens_set_lookup_aux"><span class="id" title="lemma">_map_lens_set_lookup_aux</span></a> {<a id="S:237" class="idref" href="#S:237"><span class="id" title="binder">S</span></a>} (<a id="s:238" class="idref" href="#s:238"><span class="id" title="binder">s</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:237"><span class="id" title="variable">S</span></a>) <a id="rn:239" class="idref" href="#rn:239"><span class="id" title="binder">rn</span></a> (<a id="_key_lens:240" class="idref" href="#_key_lens:240"><span class="id" title="binder">_key_lens</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#S:237"><span class="id" title="variable">S</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) (<a id="m:241" class="idref" href="#m:241"><span class="id" title="binder">m</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlens:243" class="idref" href="#Hlens:243"><span class="id" title="binder">Hlens</span></a> : <span class="id" title="notation">∀</span> <a id="k:242" class="idref" href="#k:242"><span class="id" title="binder">k</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_key_lens:240"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:242"><span class="id" title="variable">k</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hdisj:248" class="idref" href="#Hdisj:248"><span class="id" title="binder">Hdisj</span></a> : <span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="k1:244" class="idref" href="#k1:244"><span class="id" title="binder">k1</span></a> <a id="k2:245" class="idref" href="#k2:245"><span class="id" title="binder">k2</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a>) <a id="s:246" class="idref" href="#s:246"><span class="id" title="binder">s</span></a> <a id="v:247" class="idref" href="#v:247"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#k1:244"><span class="id" title="variable">k1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#k2:245"><span class="id" title="variable">k2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#s:246"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#_key_lens:240"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k1:244"><span class="id" title="variable">k1</span></a> <span class="id" title="notation">.=</span> <a class="idref" href="bluerock.prelude.lens.html#v:247"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:240"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k2:245"><span class="id" title="variable">k2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#s:246"><span class="id" title="variable">s</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:240"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k2:245"><span class="id" title="variable">k2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#rn:239"><span class="id" title="variable">rn</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#dom"><span class="id" title="definition">dom</span></a> <a class="idref" href="bluerock.prelude.lens.html#m:241"><span class="id" title="variable">m</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#m:241"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:239"><span class="id" title="variable">rn</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#s:238"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#_map_lens"><span class="id" title="definition">_map_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:240"><span class="id" title="variable">_key_lens</span></a> <span class="id" title="notation">.=</span> <a class="idref" href="bluerock.prelude.lens.html#m:241"><span class="id" title="variable">m</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:240"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:239"><span class="id" title="variable">rn</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.prelude.lens.html#_map_lens"><span class="id" title="definition">_map_lens</span></a>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> <span class="id" title="var">Hi1</span> <span class="id" title="var">Hi2</span> <span class="id" title="var">IH</span>] <span class="id" title="keyword">using</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_maps.html#map_first_key_ind"><span class="id" title="lemma">map_first_key_ind</span></a>; [<span class="id" title="var">set_solver</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_maps.html#map_fold_insert_first_key"><span class="id" title="lemma">map_fold_insert_first_key</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_map_dom.html#dom_insert"><span class="id" title="lemma">dom_insert</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#elem_of_union"><span class="id" title="method">elem_of_union</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#elem_of_singleton"><span class="id" title="method">elem_of_singleton</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span> =&gt; [-&gt; | <span class="id" title="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_maps.html#lookup_insert"><span class="id" title="lemma">lookup_insert</span></a> /=. <span class="id" title="var">f_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="bluerock.prelude.lens.html#view_over"><span class="id" title="projection">view_over</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">have</span> ? : <span class="id" title="var">i</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">rn</span> <span class="id" title="tactic">by</span> <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_maps.html#lookup_insert_ne"><span class="id" title="lemma">lookup_insert_ne</span></a> //= <span class="id" title="var">IH</span> // <span class="id" title="var">Hdisj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="_map_lens_set_lookup" class="idref" href="#_map_lens_set_lookup"><span class="id" title="lemma">_map_lens_set_lookup</span></a> {<a id="S:249" class="idref" href="#S:249"><span class="id" title="binder">S</span></a>} (<a id="s:250" class="idref" href="#s:250"><span class="id" title="binder">s</span></a> : <a class="idref" href="bluerock.prelude.lens.html#S:249"><span class="id" title="variable">S</span></a>) <a id="rn:251" class="idref" href="#rn:251"><span class="id" title="binder">rn</span></a> (<a id="_key_lens:252" class="idref" href="#_key_lens:252"><span class="id" title="binder">_key_lens</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#S:249"><span class="id" title="variable">S</span></a> <span class="id" title="notation">-</span><span class="id" title="notation">l</span><span class="id" title="notation">&gt;</span> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) (<a id="m:253" class="idref" href="#m:253"><span class="id" title="binder">m</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.M"><span class="id" title="variable">M</span></a> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.V"><span class="id" title="variable">V</span></a>) <a id="v:254" class="idref" href="#v:254"><span class="id" title="binder">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlens:256" class="idref" href="#Hlens:256"><span class="id" title="binder">Hlens</span></a> : <span class="id" title="notation">∀</span> <a id="k:255" class="idref" href="#k:255"><span class="id" title="binder">k</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#LensLaws'"><span class="id" title="record">LensLaws'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<a class="idref" href="bluerock.prelude.lens.html#_key_lens:252"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k:255"><span class="id" title="variable">k</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hdisj:261" class="idref" href="#Hdisj:261"><span class="id" title="binder">Hdisj</span></a> : <span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="k1:257" class="idref" href="#k1:257"><span class="id" title="binder">k1</span></a> <a id="k2:258" class="idref" href="#k2:258"><span class="id" title="binder">k2</span></a> : <a class="idref" href="bluerock.prelude.lens.html#map_from_finite.K"><span class="id" title="variable">K</span></a>) <a id="s:259" class="idref" href="#s:259"><span class="id" title="binder">s</span></a> <a id="v:260" class="idref" href="#v:260"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.prelude.lens.html#k1:257"><span class="id" title="variable">k1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="bluerock.prelude.lens.html#k2:258"><span class="id" title="variable">k2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#s:259"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#_key_lens:252"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k1:257"><span class="id" title="variable">k1</span></a> <span class="id" title="notation">.=</span> <a class="idref" href="bluerock.prelude.lens.html#v:260"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:252"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k2:258"><span class="id" title="variable">k2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#s:259"><span class="id" title="variable">s</span></a> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:252"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#k2:258"><span class="id" title="variable">k2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.prelude.lens.html#m:253"><span class="id" title="variable">m</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:251"><span class="id" title="variable">rn</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:254"><span class="id" title="variable">v</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#s:250"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&amp;:</span> <span class="id" title="notation">(</span><a class="idref" href="bluerock.prelude.lens.html#_map_lens"><span class="id" title="definition">_map_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:252"><span class="id" title="variable">_key_lens</span></a> <span class="id" title="notation">.=</span> <a class="idref" href="bluerock.prelude.lens.html#m:253"><span class="id" title="variable">m</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">.^</span> <a class="idref" href="bluerock.prelude.lens.html#_key_lens:252"><span class="id" title="variable">_key_lens</span></a> <a class="idref" href="bluerock.prelude.lens.html#rn:251"><span class="id" title="variable">rn</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.prelude.lens.html#v:254"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt;/<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b"><span class="id" title="notation">[</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b"><span class="id" title="notation">dup</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b"><span class="id" title="notation">]</span></a> <span class="id" title="var">Hlook</span> /(<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.fin_map_dom.html#elem_of_dom_2"><span class="id" title="lemma">elem_of_dom_2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#inj"><span class="id" title="definition">inj</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hlook</span> -<a class="idref" href="bluerock.prelude.lens.html#_map_lens_set_lookup_aux"><span class="id" title="lemma">_map_lens_set_lookup_aux</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.prelude.lens.html#map_from_finite"><span class="id" title="section">map_from_finite</span></a>.<br/>
</div>
<!--
-- Copyright (c) 2020 BlueRock Security, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
