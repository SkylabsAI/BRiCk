<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
-- Copyright (c) 2020 BlueRock Security, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="../../css/coqdocjs/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="../../css/coqdocjs/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../js/coqdocjs/config.js"></script>
<script type="text/javascript" src="../../js/coqdocjs/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <!-- NOTE: These are displayed right to left on the page -->
    <span class="right">
      <a href="./indexpage.html"> Index for the theory </a>
      <a href="./toc.html"> Table of contents for the theory </a>
      <a href="../../../index.html"> Toplevel </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">bluerock.iris.extra.wp_io.iris.ghost</h1>

<div class="code">
<span class="comment">(*<br/>
&nbsp;*&nbsp;Copyright&nbsp;(c)&nbsp;2023&nbsp;BlueRock&nbsp;Security,&nbsp;Inc.<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;This&nbsp;software&nbsp;is&nbsp;distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;BedRock&nbsp;Open-Source&nbsp;License.<br/>
&nbsp;*&nbsp;See&nbsp;the&nbsp;LICENSE-BedRock&nbsp;file&nbsp;in&nbsp;the&nbsp;repository&nbsp;root&nbsp;for&nbsp;details.<br/>
<br/>
&nbsp;*&nbsp;ALL&nbsp;of&nbsp;the&nbsp;following&nbsp;code&nbsp;is&nbsp;derived&nbsp;from&nbsp;code&nbsp;original&nbsp;to&nbsp;the<br/>
&nbsp;*&nbsp;Iris&nbsp;project.&nbsp;That&nbsp;original&nbsp;code&nbsp;is<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;Iris&nbsp;developers&nbsp;and&nbsp;contributors<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;and&nbsp;used&nbsp;according&nbsp;to&nbsp;the&nbsp;following&nbsp;license.<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPDX-License-Identifier:&nbsp;BSD-3-Clause<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;Original&nbsp;Iris&nbsp;License:<br/>
&nbsp;*&nbsp;https://gitlab.mpi-sws.org/iris/iris/-/blob/cb324b81f5b00a7cb8ae186d7aca5011350037cd/LICENSE-CODE<br/>
&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
This generalize <span class="inlinecode"><span class="id" title="var">iris.program_logic.weakestpre.irisGS_gen</span></span>
(in `iris/program_logic/weakestpre.v`) to any PROP.

<div class="paragraph"> </div>

TODO : upstream.

</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.fancy_updates.html#"><span class="id" title="library">iris.base_logic.lib.fancy_updates</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#"><span class="id" title="library">iris.program_logic.language</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#"><span class="id" title="library">iris.bi.weakestpre</span></a>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="irisGS_gen" class="idref" href="#irisGS_gen"><span class="id" title="record">irisGS_gen</span></a> (<a id="aed330fafc52497700df4a17b24e754e" class="idref" href="#aed330fafc52497700df4a17b24e754e"><span class="id" title="binder">Λ</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#language"><span class="id" title="record">language</span></a>) (<a id="PROP:2" class="idref" href="#PROP:2"><span class="id" title="binder">PROP</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi"><span class="id" title="record">bi</span></a>) `{<a id="H:3" class="idref" href="#H:3"><span class="id" title="binder">FUpd</span></a> <a id="H:3" class="idref" href="#H:3"><span class="id" title="binder">PROP</span></a>} := <span class="id" title="var">IrisG</span> {<br/>
<br/>
&nbsp;&nbsp;</div>

<div class="doc">
The state interpretation is an invariant that should hold in
  between each step of reduction. Here <span class="inlinecode"><span class="id" title="var">Λstate</span></span> is the global state,
  the first <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a></span> is the number of steps already performed by the
  program, <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.bi.big_op.html#big_op.list"><span class="id" title="section">list</span></a></span> <span class="inlinecode">(<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#observation"><span class="id" title="projection">observation</span></a></span> <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#744fefb7a196503db6b4b830834a34c2"><span class="id" title="variable">Λ</span></a>)</span> are the remaining observations, and the
  last <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a></span> is the number of forked-off threads (not the total number
  of threads, which is one higher because there is always a main
  thread). 
</div>
<div class="code">
&nbsp;&nbsp;<a id="state_interp" class="idref" href="#state_interp"><span class="id" title="projection">state_interp</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#state"><span class="id" title="projection">state</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#aed330fafc52497700df4a17b24e754e"><span class="id" title="variable">Λ</span></a> <span class="id" title="notation">→</span> <a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <span class="id" title="notation">→</span> <a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#observation"><span class="id" title="projection">observation</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#aed330fafc52497700df4a17b24e754e"><span class="id" title="variable">Λ</span></a>) <span class="id" title="notation">→</span> <a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <span class="id" title="notation">→</span> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#PROP:2"><span class="id" title="variable">PROP</span></a>;<br/>
<br/>
&nbsp;&nbsp;</div>

<div class="doc">
A fixed postcondition for any forked-off thread. For most languages, e.g.
  heap_lang, this will simply be <span class="inlinecode"><span class="id" title="var">True</span></span>. However, it is useful if one wants to
  keep track of resources precisely, as in e.g. Iron. 
</div>
<div class="code">
&nbsp;&nbsp;<a id="fork_post" class="idref" href="#fork_post"><span class="id" title="projection">fork_post</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#val"><span class="id" title="projection">val</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#aed330fafc52497700df4a17b24e754e"><span class="id" title="variable">Λ</span></a> <span class="id" title="notation">→</span> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#PROP:2"><span class="id" title="variable">PROP</span></a>;<br/>
<br/>
&nbsp;&nbsp;</div>

<div class="doc">
The number of additional logical steps (i.e., later modality in the
  definition of WP) and later credits per physical step is
  <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#num_laters_per_step"><span class="id" title="projection">num_laters_per_step</span></a></span> <span class="inlinecode"><span class="id" title="var">ns</span>)</span>, where <span class="inlinecode"><span class="id" title="var">ns</span></span> is the number of physical steps
  executed so far. We add one to <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#num_laters_per_step"><span class="id" title="projection">num_laters_per_step</span></a></span> to ensure that there
  is always at least one later and later credit for each physical step. 
</div>
<div class="code">
&nbsp;&nbsp;<a id="num_laters_per_step" class="idref" href="#num_laters_per_step"><span class="id" title="projection">num_laters_per_step</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <span class="id" title="notation">→</span> <a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
<br/>
&nbsp;&nbsp;</div>

<div class="doc">
When performing pure steps, the state interpretation needs to be
  adapted for the change in the <span class="inlinecode"><span class="id" title="var">ns</span></span> parameter.

<div class="paragraph"> </div>

  Note that we use an empty-mask fancy update here. We could also use
  a basic update or a bare magic wand, the expressiveness of the
  framework would be the same. If we removed the modality here, then
  the client would have to include the modality it needs as part of
  the definition of <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#state_interp"><span class="id" title="projection">state_interp</span></a></span>. Since adding the modality as part
  of the definition <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#state_interp_mono"><span class="id" title="projection">state_interp_mono</span></a></span> does not significantly
  complicate the formalization in Iris, we prefer simplifying the
  client. 
</div>
<div class="code">
&nbsp;&nbsp;<a id="state_interp_mono" class="idref" href="#state_interp_mono"><span class="id" title="projection">state_interp_mono</span></a> <a id="adf3bc8341a90edf65bb756c93872ed9" class="idref" href="#adf3bc8341a90edf65bb756c93872ed9"><span class="id" title="binder">σ</span></a> <a id="ns:9" class="idref" href="#ns:9"><span class="id" title="binder">ns</span></a> <a id="5516f4631530f6853917040619893683" class="idref" href="#5516f4631530f6853917040619893683"><span class="id" title="binder">κs</span></a> <a id="nt:11" class="idref" href="#nt:11"><span class="id" title="binder">nt</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#state_interp:5"><span class="id" title="method">state_interp</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#adf3bc8341a90edf65bb756c93872ed9"><span class="id" title="variable">σ</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#ns:9"><span class="id" title="variable">ns</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#5516f4631530f6853917040619893683"><span class="id" title="variable">κs</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#nt:11"><span class="id" title="variable">nt</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#e55eb026c3f0434cd18ddc04e5d7c1ac"><span class="id" title="notation">⊢</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#7500ef6d8f565186818a5daedd71bf2a"><span class="id" title="notation">|={</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#7500ef6d8f565186818a5daedd71bf2a"><span class="id" title="notation">}=&gt;</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#state_interp:5"><span class="id" title="method">state_interp</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#adf3bc8341a90edf65bb756c93872ed9"><span class="id" title="variable">σ</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.1+alpha/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#ns:9"><span class="id" title="variable">ns</span></a>) <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#5516f4631530f6853917040619893683"><span class="id" title="variable">κs</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#nt:11"><span class="id" title="variable">nt</span></a><br/>
}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#IrisG"><span class="id" title="constructor">IrisG</span></a> {<span class="id" title="var">Λ</span> <span class="id" title="var">PROP</span> <span class="id" title="var">_</span>}.<br/>
</div>
<!--
-- Copyright (c) 2020 BlueRock Security, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
