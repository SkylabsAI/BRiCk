<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
-- Copyright (c) 2020 BlueRock Security, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="../../css/coqdocjs/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="../../css/coqdocjs/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../js/coqdocjs/config.js"></script>
<script type="text/javascript" src="../../js/coqdocjs/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <!-- NOTE: These are displayed right to left on the page -->
    <span class="right">
      <a href="./indexpage.html"> Index for the theory </a>
      <a href="./toc.html"> Table of contents for the theory </a>
      <a href="../../../index.html"> Toplevel </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">bluerock.iris.extra.wp_io.refinement.wp_io</h1>

<div class="code">
<span class="comment">(*<br/>
&nbsp;*&nbsp;Copyright&nbsp;(c)&nbsp;2023&nbsp;BlueRock&nbsp;Security,&nbsp;Inc.<br/>
&nbsp;*<br/>
&nbsp;*&nbsp;This&nbsp;software&nbsp;is&nbsp;distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;BedRock&nbsp;Open-Source&nbsp;License.<br/>
&nbsp;*&nbsp;See&nbsp;the&nbsp;LICENSE-BedRock&nbsp;file&nbsp;in&nbsp;the&nbsp;repository&nbsp;root&nbsp;for&nbsp;details.<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab108"></a><h1 class="section">Connecting the input-output WP of a language to the Iris WP of the</h1>

same language. Note that this lemma does not do any decomposition, and
only changes the way that IO is handled.

<div class="paragraph"> </div>

This instantiates the refinement relation. There are two variants here:
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">refine_embed.wp_io_run_embed</span></span> one uses the state interpretation that embeds
  the refinement relation.

</li>
<li> <span class="inlinecode"><span class="id" title="var">refine_inv.wp_io_run_inv</span></span> uses the explicit root invariant.

</li>
</ul>

<div class="paragraph"> </div>

Note the difference between the statements of the former and the latter.
The former simply says `WPio e ⊢ WPiris e`, while the latter
says `root_inv ⊢ WPio e -* WPiris e`.

<div class="paragraph"> </div>

PROs and CONs:

<div class="paragraph"> </div>

For the <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.adequacy.html#refine_embed"><span class="id" title="module">refine_embed</span></a></span> version :
<ul class="doclist">
<li> PRO: simple setup, no need of extra ghost state, nor extra invariant

</li>
<li> CON: the refinement relation is only accessible through a WP,
  because the refinement inside the <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#state_interp"><span class="id" title="projection">state_interp</span></a></span>. This may not really be
  a CON, if we only care about the refinement relation once we have left
  the logic.

</li>
</ul>

<div class="paragraph"> </div>

For the <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.adequacy.html#refine_inv"><span class="id" title="module">refine_inv</span></a></span> version :
<ul class="doclist">
<li> CON: needs extra ghost state (<span class="inlinecode"><span class="id" title="var">mono_list.half</span></span> <span class="inlinecode"><span class="id" title="var">γ_con</span></span> <span class="inlinecode"><span class="id" title="var">tr_con</span></span>)

</li>
<li> PRO: we can access the refinement relation within the logic.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

TODO: generalize this from using <span class="inlinecode"><span class="id" title="var">Compose.config</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#"><span class="id" title="library">bluerock.iris.extra.bi.atomic_commit</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.iris.extra.bi.atomic_update.html#"><span class="id" title="library">bluerock.iris.extra.bi.atomic_update</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.inv.html#"><span class="id" title="library">bluerock.iris.extra.wp_io.refinement.inv</span></a>.<br/>

<br/>
<a id="root_aux_1" class="idref" href="#root_aux_1"><span class="id" title="module"><span id="root_aux_1.root" class="id">NES.Begin</span></span></a> <a id="root_aux_1" class="idref" href="#root_aux_1"><span class="id" title="module"><span id="root_aux_1.root" class="id">root</span></span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a id="root_aux_1.root.with_app" class="idref" href="#root_aux_1.root.with_app"><span class="id" title="section">with_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a class="idref" href="bluerock.iris.extra.bi.prop_constraints.html#Ghostly"><span class="id" title="class">Ghostly</span></a> <span class="id" title="var">PROP</span>} `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#BiFUpd"><span class="id" title="class">BiFUpd</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#PROP:1"><span class="id" title="variable">PROP</span></a>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="root_aux_1.root.with_app.x" class="idref" href="#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.app"><span class="id" title="class">App.app</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App"><span class="id" title="module">App</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> (<span class="id" title="var">γ</span> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.gname"><span class="id" title="record">AuthSet.gname</span></a>).<br/>

<br/>
</div>

<div class="doc">
A copy of the refinement framework's <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.committer"><span class="id" title="definition">committer</span></a></span> and <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.requester"><span class="id" title="definition">requester</span></a></span>,
    because we need to have more choices on masks.

<div class="paragraph"> </div>

    TODO (FM-3811):
    In the decomposition of the framework, ownership is not atomically passed
    one app C1 to another app C2 or vice versa. The updates of the components
    are meant to be executed one after the other, that is, one must run all
    C1's updates, using all available invariants from the masks, and restablish
    the invariants again, before C2's updates can be run, which can all use
    all invariants. It does not support partially running C1, then partially
    running C2, which would allow for atomic arbitrary resources trading between
    C1 and C2 and the invariants.
    The solution to this problem is to index the <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.requester"><span class="id" title="definition">requester</span></a></span> and <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.committer"><span class="id" title="definition">committer</span></a></span> by
    a mask <span class="inlinecode"><a class="idref" href="bluerock.iris.extra.bi.spec.frac_splittable.html#frac_9.E"><span class="id" title="variable">E</span></a></span> which be picked by the clients (of the refinement framework) such
    that the masks of a pair of requester and committer are disjoint, and they
    can be run in any order.

<div class="paragraph"> </div>

    Below, we duplicate the definitions with the empty masks, which are
    sufficiet for the proofs in the demo. Once we apply the generalization for
    committers and requesters, the duplicated definitions can be removed.
    
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="root_aux_1.root.committer" class="idref" href="#root_aux_1.root.committer"><span class="id" title="definition">committer</span></a> <a id="368b0b0ed1c55876db07443f6c6c7a4b" class="idref" href="#368b0b0ed1c55876db07443f6c6c7a4b"><span class="id" title="binder">γ</span></a> (<a id="STEP:6" class="idref" href="#STEP:6"><span class="id" title="binder">STEP</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#propset"><span class="id" title="record">propset</span></a> (<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.evt"><span class="id" title="method">evt</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a>)) (<a id="Q:7" class="idref" href="#Q:7"><span class="id" title="binder">Q</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.evt"><span class="id" title="method">evt</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.PROP"><span class="id" title="variable">PROP</span></a>) : <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.PROP"><span class="id" title="variable">PROP</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">AU</span></a>  <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">∃∃</span></a> <a id="sset:8" class="idref" href="#sset:8"><span class="id" title="binder"><span id="sset:12" class="id"><span id="sset:13" class="id"><span id="sset:17" class="id">sset</span></span></span></span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.auth"><span class="id" title="definition">AuthSet.auth</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#368b0b0ed1c55876db07443f6c6c7a4b"><span class="id" title="variable">γ</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#sset:12"><span class="id" title="variable">sset</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">@</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">∀∀</span></a> <a id="s:9" class="idref" href="#s:9"><span class="id" title="binder"><span id="s:14" class="id"><span id="s:18" class="id">s</span></span></span></a> <a id="e:10" class="idref" href="#e:10"><span class="id" title="binder"><span id="e:15" class="id"><span id="e:19" class="id">e</span></span></span></a> <a id="s':11" class="idref" href="#s':11"><span class="id" title="binder"><span id="s':16" class="id"><span id="s':20" class="id">s'</span></span></span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:14"><span class="id" title="variable">s</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#sset:13"><span class="id" title="variable">sset</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:15"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#STEP:6"><span class="id" title="variable">STEP</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a>.(<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.lts"><span class="id" title="method">lts</span></a>).(<span class="id" title="abbreviation">lts_step</span>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:14"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:15"><span class="id" title="variable">e</span></a>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':16"><span class="id" title="variable">s'</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.auth_exact"><span class="id" title="definition">AuthSet.auth_exact</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#368b0b0ed1c55876db07443f6c6c7a4b"><span class="id" title="variable">γ</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':16"><span class="id" title="variable">s'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">COMM</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#Q:7"><span class="id" title="variable">Q</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:19"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#371ddf8d5992abff9bd4e7fde7019058"><span class="id" title="notation">}&gt;</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="root_aux_1.root.requester" class="idref" href="#root_aux_1.root.requester"><span class="id" title="definition">requester</span></a> <a id="cf6aa9dd96fbb1b0b51132ecb076c581" class="idref" href="#cf6aa9dd96fbb1b0b51132ecb076c581"><span class="id" title="binder">γ</span></a> (<a id="STEP:22" class="idref" href="#STEP:22"><span class="id" title="binder">STEP</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#propset"><span class="id" title="record">propset</span></a> (<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.evt"><span class="id" title="method">evt</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a>)) (<a id="Q:23" class="idref" href="#Q:23"><span class="id" title="binder">Q</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.evt"><span class="id" title="method">evt</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.PROP"><span class="id" title="variable">PROP</span></a>) : <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.PROP"><span class="id" title="variable">PROP</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">AC</span></a>  <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">∀</span></a> <a id="s:24" class="idref" href="#s:24"><span class="id" title="binder"><span id="s:26" class="id"><span id="s:27" class="id"><span id="s:30" class="id"><span id="s:31" class="id"><span id="s:36" class="id"><span id="s:37" class="id">s</span></span></span></span></span></span></span></a><a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.frag_exact"><span class="id" title="definition">AuthSet.frag_exact</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#cf6aa9dd96fbb1b0b51132ecb076c581"><span class="id" title="variable">γ</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:27"><span class="id" title="variable">s</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <span class="comment">(*The&nbsp;model&nbsp;is&nbsp;safe&nbsp;to&nbsp;step&nbsp;any&nbsp;event&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="var">STEP</span></span>.*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a id="e:28" class="idref" href="#e:28"><span class="id" title="binder">e</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:28"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#STEP:22"><span class="id" title="variable">STEP</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="s':29" class="idref" href="#s':29"><span class="id" title="binder">s'</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a>.(<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.lts"><span class="id" title="method">lts</span></a>).(<span class="id" title="abbreviation">lts_step</span>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:27"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:28"><span class="id" title="variable">e</span></a>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':29"><span class="id" title="variable">s'</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">@</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a><a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">,</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">∃</span></a> <a id="e:25" class="idref" href="#e:25"><span class="id" title="binder"><span id="e:32" class="id"><span id="e:33" class="id"><span id="e:38" class="id"><span id="e:39" class="id">e</span></span></span></span></span></a><a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:33"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#STEP:22"><span class="id" title="variable">STEP</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.frag"><span class="id" title="definition">AuthSet.frag</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#cf6aa9dd96fbb1b0b51132ecb076c581"><span class="id" title="variable">γ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">{[</span></a> <a id="s':34" class="idref" href="#s':34"><span class="id" title="binder"><span id="s':35" class="id">s'</span></span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app.x"><span class="id" title="variable">x</span></a>.(<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.lts"><span class="id" title="method">lts</span></a>).(<span class="id" title="abbreviation">lts_step</span>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:31"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:33"><span class="id" title="variable">e</span></a>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':34"><span class="id" title="variable">s'</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">]}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">COMM</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#Q:23"><span class="id" title="variable">Q</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:39"><span class="id" title="variable">e</span></a> <a class="idref" href="bluerock.iris.extra.bi.atomic_commit.html#c39d3af89df1b2dac525e9f45488a620"><span class="id" title="notation">&gt;&gt;</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.with_app"><span class="id" title="section">with_app</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="root_aux_1.root.stateI_io" class="idref" href="#root_aux_1.root.stateI_io"><span class="id" title="section">stateI_io</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="root_aux_1.root.stateI_io.PROP" class="idref" href="#root_aux_1.root.stateI_io.PROP"><span class="id" title="variable">PROP</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi"><span class="id" title="record">bi</span></a>} `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#BiFUpd"><span class="id" title="class">BiFUpd</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#PROP:40"><span class="id" title="variable">PROP</span></a>} `{!<a class="idref" href="bluerock.iris.extra.bi.prop_constraints.html#Ghostly"><span class="id" title="class">Ghostly</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#PROP:40"><span class="id" title="variable">PROP</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="root_aux_1.root.stateI_io.cfg" class="idref" href="#root_aux_1.root.stateI_io.cfg"><span class="id" title="variable">cfg</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.config"><span class="id" title="record">Compose.config</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="root_aux_1.root.stateI_io.absA" class="idref" href="#root_aux_1.root.stateI_io.absA"><span class="id" title="variable">absA</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.app"><span class="id" title="class">App.app</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <a id="root_aux_1.root.stateI_io.absE" class="idref" href="#root_aux_1.root.stateI_io.absE"><span class="id" title="variable">absE</span></a> := <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.evt"><span class="id" title="method">App.evt</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.absA"><span class="id" title="variable">absA</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <a id="eb1d59cd84436d87e92762021055d64a" class="idref" href="#eb1d59cd84436d87e92762021055d64a"><span class="id" title="variable">Λ</span></a> := <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.lts_lang"><span class="id" title="definition">Compose.lts_lang</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.cfg"><span class="id" title="variable">cfg</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="root_aux_1.root.stateI_io.R" class="idref" href="#root_aux_1.root.stateI_io.R"><span class="id" title="variable">R</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.absE"><span class="id" title="variable">absE</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.event"><span class="id" title="projection">Compose.event</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.cfg"><span class="id" title="variable">cfg</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="root_aux_1.root.input_spec" class="idref" href="#root_aux_1.root.input_spec"><span class="id" title="definition">input_spec</span></a> (<a id="26d1c47bdab935efa8c8134fcd6a6761" class="idref" href="#26d1c47bdab935efa8c8134fcd6a6761"><span class="id" title="binder">γ_abs</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.gname"><span class="id" title="record">AuthSet.gname</span></a>) (<a id="bf2cf916ae7047b7055eb7606445a7b8" class="idref" href="#bf2cf916ae7047b7055eb7606445a7b8"><span class="id" title="binder">κ</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#observation"><span class="id" title="projection">observation</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#eb1d59cd84436d87e92762021055d64a"><span class="id" title="variable">Λ</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#PrePost"><span class="id" title="record">PrePost</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.PROP"><span class="id" title="variable">PROP</span></a> := {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#tele_pre"><span class="id" title="projection">tele_pre</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#bf2cf916ae7047b7055eb7606445a7b8"><span class="id" title="variable">κ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">tele</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">(</span></a><a id="Q:49" class="idref" href="#Q:49"><span class="id" title="binder">Q</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.absE"><span class="id" title="variable">absE</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.PROP"><span class="id" title="variable">PROP</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">)]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">tele</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#tele_post"><span class="id" title="projection">tele_post</span></a> <span class="id" title="var">_</span> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">tele</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">]</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#pre"><span class="id" title="projection">pre</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#bf2cf916ae7047b7055eb7606445a7b8"><span class="id" title="variable">κ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">e</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.is_input"><span class="id" title="projection">Compose.is_input</span></a> <span class="id" title="var">e</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;only&nbsp;if&nbsp;e&nbsp;is&nbsp;an&nbsp;input&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#tele_app"><span class="id" title="definition">tele_app</span></a> (<span class="id" title="notation">λ</span> <a id="Q:51" class="idref" href="#Q:51"><span class="id" title="binder">Q</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.committer"><span class="id" title="definition">root.committer</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.absA"><span class="id" title="variable">absA</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#26d1c47bdab935efa8c8134fcd6a6761"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">{[</span></a> <a id="ae:52" class="idref" href="#ae:52"><span class="id" title="binder"><span id="ae:53" class="id">ae</span></span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:52"><span class="id" title="variable">ae</span></a> <span class="id" title="var">e</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">]}</span></a> (<span class="id" title="notation">λ</span> <a id="ae:54" class="idref" href="#ae:54"><span class="id" title="binder">ae</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:54"><span class="id" title="variable">ae</span></a> <span class="id" title="var">e</span> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#Q:51"><span class="id" title="variable">Q</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:54"><span class="id" title="variable">ae</span></a>)%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="notation">λ</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">λ</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#post"><span class="id" title="projection">post</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#bf2cf916ae7047b7055eb7606445a7b8"><span class="id" title="variable">κ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">e</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">λ</span> <a id="args1:56" class="idref" href="#args1:56"><span class="id" title="binder">args1</span></a> <span class="id" title="var">_</span><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.is_input"><span class="id" title="projection">Compose.is_input</span></a> <span class="id" title="var">e</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#tele_app"><span class="id" title="definition">tele_app</span></a> (<span class="id" title="var">TT</span>:= <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">tele</span></a> <span class="id" title="var">_</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">]</span></a>) (<span class="id" title="notation">λ</span> <a id="Q:57" class="idref" href="#Q:57"><span class="id" title="binder">Q</span></a><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">∃</span></a> <a id="ae:58" class="idref" href="#ae:58"><span class="id" title="binder">ae</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:58"><span class="id" title="variable">ae</span></a> <span class="id" title="var">e</span> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#Q:57"><span class="id" title="variable">Q</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:58"><span class="id" title="variable">ae</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#args1:56"><span class="id" title="variable">args1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">λ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ;<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="root_aux_1.root.output_spec" class="idref" href="#root_aux_1.root.output_spec"><span class="id" title="definition">output_spec</span></a> (<a id="29da3e3b5ecf69793660dd88d19ace6a" class="idref" href="#29da3e3b5ecf69793660dd88d19ace6a"><span class="id" title="binder">γ_abs</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.gname"><span class="id" title="record">AuthSet.gname</span></a>) (<a id="ff27b6074b74cb4bc42f1f2e12e62a91" class="idref" href="#ff27b6074b74cb4bc42f1f2e12e62a91"><span class="id" title="binder">κ</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#observation"><span class="id" title="projection">observation</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#eb1d59cd84436d87e92762021055d64a"><span class="id" title="variable">Λ</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#PrePost"><span class="id" title="record">PrePost</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.PROP"><span class="id" title="variable">PROP</span></a> := {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#tele_pre"><span class="id" title="projection">tele_pre</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ff27b6074b74cb4bc42f1f2e12e62a91"><span class="id" title="variable">κ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">tele</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">(</span></a><a id="Q:62" class="idref" href="#Q:62"><span class="id" title="binder">Q</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.PROP"><span class="id" title="variable">PROP</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">)]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">tele</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#tele_post"><span class="id" title="projection">tele_post</span></a> <span class="id" title="var">_</span> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">tele</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#d80354fa0e02aee56d24df6294b9ea48"><span class="id" title="notation">]</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#pre"><span class="id" title="projection">pre</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ff27b6074b74cb4bc42f1f2e12e62a91"><span class="id" title="variable">κ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">e</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.is_input"><span class="id" title="projection">Compose.is_input</span></a> <span class="id" title="var">e</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;only&nbsp;if&nbsp;e&nbsp;is&nbsp;an&nbsp;output&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#tele_app"><span class="id" title="definition">tele_app</span></a> (<span class="id" title="notation">λ</span> <a id="Q:64" class="idref" href="#Q:64"><span class="id" title="binder">Q</span></a><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">∃</span></a> <a id="ae:65" class="idref" href="#ae:65"><span class="id" title="binder">ae</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:65"><span class="id" title="variable">ae</span></a> <span class="id" title="var">e</span> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.requester"><span class="id" title="definition">root.requester</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.absA"><span class="id" title="variable">absA</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#29da3e3b5ecf69793660dd88d19ace6a"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">{[</span></a> <a id="ae':66" class="idref" href="#ae':66"><span class="id" title="binder"><span id="ae':67" class="id">ae'</span></span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae':66"><span class="id" title="variable">ae'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:65"><span class="id" title="variable">ae</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">]}</span></a> (<span class="id" title="notation">λ</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#Q:64"><span class="id" title="variable">Q</span></a>))%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">λ</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">λ</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#post"><span class="id" title="projection">post</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ff27b6074b74cb4bc42f1f2e12e62a91"><span class="id" title="variable">κ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">e</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">λ</span> <a id="args1:69" class="idref" href="#args1:69"><span class="id" title="binder">args1</span></a> <span class="id" title="var">_</span><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.is_input"><span class="id" title="projection">Compose.is_input</span></a> <span class="id" title="var">e</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#tele_app"><span class="id" title="definition">tele_app</span></a> (<span class="id" title="var">TT</span>:= <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">tele</span></a> <span class="id" title="var">_</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#de416870734411840fbb72c30989a8c0"><span class="id" title="notation">]</span></a>) (<span class="id" title="notation">λ</span> <a id="Q:70" class="idref" href="#Q:70"><span class="id" title="binder">Q</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#Q:70"><span class="id" title="variable">Q</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#args1:69"><span class="id" title="variable">args1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">λ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="root_aux_1.root.inout_irisGS_gen_instance" class="idref" href="#root_aux_1.root.inout_irisGS_gen_instance"><span class="id" title="definition">inout_irisGS_gen_instance</span></a> <a id="846709d72d4d7389d1c6aa7f2a8f78e1" class="idref" href="#846709d72d4d7389d1c6aa7f2a8f78e1"><span class="id" title="binder">γ</span></a> `{<a id="irisGS_gen0:72" class="idref" href="#irisGS_gen0:72"><span class="id" title="binder">!</span></a><a id="irisGS_gen0:72" class="idref" href="#irisGS_gen0:72"><span class="id" title="binder">irisGS_gen</span></a> <a id="irisGS_gen0:72" class="idref" href="#irisGS_gen0:72"><span class="id" title="binder">Λ</span></a> <a id="irisGS_gen0:72" class="idref" href="#irisGS_gen0:72"><span class="id" title="binder">PROP</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#inout_irisGS_gen"><span class="id" title="class">inout_irisGS_gen</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#eb1d59cd84436d87e92762021055d64a"><span class="id" title="variable">Λ</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io.PROP"><span class="id" title="variable">PROP</span></a> := {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#ctx_irisGS_gen"><span class="id" title="method">ctx_irisGS_gen</span></a> := <span class="id" title="var">_</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#ctx_out_spec"><span class="id" title="method">ctx_out_spec</span></a> := <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.output_spec"><span class="id" title="definition">output_spec</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#846709d72d4d7389d1c6aa7f2a8f78e1"><span class="id" title="variable">γ</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#ctx_in_spec"><span class="id" title="method">ctx_in_spec</span></a> := <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.input_spec"><span class="id" title="definition">input_spec</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#846709d72d4d7389d1c6aa7f2a8f78e1"><span class="id" title="variable">γ</span></a> ;<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="root_aux_1.root.wp_io" class="idref" href="#root_aux_1.root.wp_io"><span class="id" title="definition">wp_io</span></a> <a id="2f860a2e9be2914d2fafd30dfa61ce72" class="idref" href="#2f860a2e9be2914d2fafd30dfa61ce72"><span class="id" title="binder">γ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="irisGS_gen0:74" class="idref" href="#irisGS_gen0:74"><span class="id" title="binder">!</span></a><a id="irisGS_gen0:74" class="idref" href="#irisGS_gen0:74"><span class="id" title="binder">irisGS_gen</span></a> <a id="irisGS_gen0:74" class="idref" href="#irisGS_gen0:74"><span class="id" title="binder">Λ</span></a> <a id="irisGS_gen0:74" class="idref" href="#irisGS_gen0:74"><span class="id" title="binder">PROP</span></a>} `{<a id="BiLaterContractive0:75" class="idref" href="#BiLaterContractive0:75"><span class="id" title="binder">!</span></a><a id="BiLaterContractive0:75" class="idref" href="#BiLaterContractive0:75"><span class="id" title="binder">BiLaterContractive</span></a> <a id="BiLaterContractive0:75" class="idref" href="#BiLaterContractive0:75"><span class="id" title="binder">PROP</span></a>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> (<span class="id" title="var">Wp</span>:=@<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#wp'"><span class="id" title="definition">inout_weakestpre.wp'</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.inout_irisGS_gen_instance"><span class="id" title="definition">inout_irisGS_gen_instance</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#2f860a2e9be2914d2fafd30dfa61ce72"><span class="id" title="variable">γ</span></a>)).<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.stateI_io"><span class="id" title="section">stateI_io</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="root_aux_1.root.wp_io" class="idref" href="#root_aux_1.root.wp_io"><span class="id" title="section">wp_io</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="root_aux_1.root.wp_io.PROP" class="idref" href="#root_aux_1.root.wp_io.PROP"><span class="id" title="variable">PROP</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi"><span class="id" title="record">bi</span></a>} `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#BiFUpd"><span class="id" title="class">BiFUpd</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#PROP:76"><span class="id" title="variable">PROP</span></a>} `{!<a class="idref" href="bluerock.iris.extra.bi.prop_constraints.html#Ghostly"><span class="id" title="class">Ghostly</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#PROP:76"><span class="id" title="variable">PROP</span></a>} `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.extensions.html#BiLaterContractive"><span class="id" title="class">BiLaterContractive</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#PROP:76"><span class="id" title="variable">PROP</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="root_aux_1.root.wp_io.cfg" class="idref" href="#root_aux_1.root.wp_io.cfg"><span class="id" title="variable">cfg</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.config"><span class="id" title="record">Compose.config</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="root_aux_1.root.wp_io.absA" class="idref" href="#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.app"><span class="id" title="class">App.app</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <a id="root_aux_1.root.wp_io.absE" class="idref" href="#root_aux_1.root.wp_io.absE"><span class="id" title="variable">absE</span></a> := <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.evt"><span class="id" title="method">App.evt</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <a id="root_aux_1.root.wp_io.absLTS" class="idref" href="#root_aux_1.root.wp_io.absLTS"><span class="id" title="variable">absLTS</span></a> := <a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.lts"><span class="id" title="method">App.lts</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="root_aux_1.root.wp_io.R" class="idref" href="#root_aux_1.root.wp_io.R"><span class="id" title="variable">R</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absE"><span class="id" title="variable">absE</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.event"><span class="id" title="projection">Compose.event</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.cfg"><span class="id" title="variable">cfg</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <a id="744fefb7a196503db6b4b830834a34c2" class="idref" href="#744fefb7a196503db6b4b830834a34c2"><span class="id" title="variable">Λ</span></a> := <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.lts_lang"><span class="id" title="definition">Compose.lts_lang</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.cfg"><span class="id" title="variable">cfg</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="root_aux_1.root.wp_io.ORG_irisGS" class="idref" href="#root_aux_1.root.wp_io.ORG_irisGS"><span class="id" title="variable">ORG_irisGS</span></a> : !<a class="idref" href="bluerock.iris.extra.wp_io.iris.ghost.html#irisGS_gen"><span class="id" title="class">irisGS_gen</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#744fefb7a196503db6b4b830834a34c2"><span class="id" title="variable">Λ</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.PROP"><span class="id" title="variable">PROP</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="root_aux_1.root.mk_committer" class="idref" href="#root_aux_1.root.mk_committer"><span class="id" title="lemma">mk_committer</span></a> <a id="9b81c6a33d60b9210c71749b8279dd12" class="idref" href="#9b81c6a33d60b9210c71749b8279dd12"><span class="id" title="binder">γ_abs</span></a> <a id="ss:85" class="idref" href="#ss:85"><span class="id" title="binder">ss</span></a> (<a id="ev:86" class="idref" href="#ev:86"><span class="id" title="binder">ev</span></a> : <a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.event"><span class="id" title="projection">Compose.event</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.cfg"><span class="id" title="variable">cfg</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.auth"><span class="id" title="definition">AuthSet.auth</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#9b81c6a33d60b9210c71749b8279dd12"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ss:85"><span class="id" title="variable">ss</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#e55eb026c3f0434cd18ddc04e5d7c1ac"><span class="id" title="notation">⊢</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.committer"><span class="id" title="definition">root.committer</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#9b81c6a33d60b9210c71749b8279dd12"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">{[</span></a> <a id="ae:87" class="idref" href="#ae:87"><span class="id" title="binder"><span id="ae:88" class="id">ae</span></span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:87"><span class="id" title="variable">ae</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ev:86"><span class="id" title="variable">ev</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">]}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">λ</span> <a id="ae:89" class="idref" href="#ae:89"><span class="id" title="binder">ae</span></a><span class="id" title="notation">,</span> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:89"><span class="id" title="variable">ae</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ev:86"><span class="id" title="variable">ev</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">∃</span></a> <a id="s:90" class="idref" href="#s:90"><span class="id" title="binder">s</span></a> <a id="s':91" class="idref" href="#s':91"><span class="id" title="binder">s'</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">,</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">[|</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:90"><span class="id" title="variable">s</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ss:85"><span class="id" title="variable">ss</span></a> <span class="id" title="notation">∧</span> <span class="id" title="abbreviation">lts_step</span> (<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.lts"><span class="id" title="method">App.lts</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s:90"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#ae:89"><span class="id" title="variable">ae</span></a>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':91"><span class="id" title="variable">s'</span></a> <a class="idref" href="bluerock.iris.extra.bi.only_provable.html#d95ff2fe2904cc1067c71e0d017740c6"><span class="id" title="notation">|]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.auth_exact"><span class="id" title="definition">AuthSet.auth_exact</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#9b81c6a33d60b9210c71749b8279dd12"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':91"><span class="id" title="variable">s'</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "sF".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.committer"><span class="id" title="definition">root.committer</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAuIntro</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.lib.atomic.html#atomic_acc"><span class="id" title="definition">atomic_acc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span> "sF". <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="var">iIntros</span> "$". }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">s</span> <span class="id" title="var">e'</span> <span class="id" title="var">s'</span>) "[%STEP sA]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">STEP</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Inss'</span> &amp; <span class="id" title="var">Eqe'</span> &amp; <span class="id" title="var">STEP</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#elem_of_PropSet"><span class="id" title="lemma">elem_of_PropSet</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Eqe'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;". <span class="id" title="var">iSplit</span>; [<span class="id" title="var">done</span>|]. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a id="root_aux_1.root.wp_io.with_embed" class="idref" href="#root_aux_1.root.wp_io.with_embed"><span class="id" title="section">with_embed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#BiBUpdFUpd"><span class="id" title="class">BiBUpdFUpd</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.PROP"><span class="id" title="variable">PROP</span></a>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;:&nbsp;not&nbsp;handling&nbsp;non-stuck&nbsp;ness&nbsp;yet.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="root_aux_1.root.wp_io_run_embed" class="idref" href="#root_aux_1.root.wp_io_run_embed"><span class="id" title="lemma">wp_io_run_embed</span></a> (<a id="fb805b9ea4cac778d7be5fedd26a8acd" class="idref" href="#fb805b9ea4cac778d7be5fedd26a8acd"><span class="id" title="binder">γ_abs</span></a> : <a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.gname"><span class="id" title="record">AuthSet.gname</span></a>) <a id="E:94" class="idref" href="#E:94"><span class="id" title="binder">E</span></a> <a id="e:95" class="idref" href="#e:95"><span class="id" title="binder">e</span></a> <a id="20af7c29ced9552218cbd19432c35c79" class="idref" href="#20af7c29ced9552218cbd19432c35c79"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io"><span class="id" title="definition">wp_io</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#fb805b9ea4cac778d7be5fedd26a8acd"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#MaybeStuck"><span class="id" title="constructor">MaybeStuck</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#E:94"><span class="id" title="variable">E</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:95"><span class="id" title="variable">e</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#20af7c29ced9552218cbd19432c35c79"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#e55eb026c3f0434cd18ddc04e5d7c1ac"><span class="id" title="notation">⊢</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bluerock.iris.extra.wp_io.refinement.inv.html#root_aux_1.root.wp_embed"><span class="id" title="definition">wp_embed</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.R"><span class="id" title="variable">R</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#fb805b9ea4cac778d7be5fedd26a8acd"><span class="id" title="variable">γ_abs</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#MaybeStuck"><span class="id" title="constructor">MaybeStuck</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#top"><span class="id" title="definition">top</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#e:95"><span class="id" title="variable">e</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#20af7c29ced9552218cbd19432c35c79"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">All</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "IH" <span class="id" title="keyword">forall</span> (<span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}/<a class="idref" href="bluerock.iris.extra.wp_io.refinement.inv.html#root_aux_1.root.wp_embed"><span class="id" title="definition">wp_embed</span></a> {2}/<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io"><span class="id" title="definition">wp_io</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#wp_unfold"><span class="id" title="lemma">wp_unfold</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.iris.weakestpre.html#wp_unfold"><span class="id" title="lemma">weakestpre.wp_unfold</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.iris.extra.wp_io.iris.weakestpre.html#wp_pre"><span class="id" title="definition">weakestpre.wp_pre</span></a> /<a class="idref" href="bluerock.iris.extra.wp_io.inout_weakestpre.html#wp_pre"><span class="id" title="definition">wp_pre</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_match</span>. { <span class="id" title="tactic">by</span> <span class="id" title="var">iMod</span> "WP" <span class="id" title="keyword">as</span> "$". }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> ([<span class="id" title="var">tr_p</span> σ1] <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "[RF SI]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "RF" <span class="id" title="keyword">as</span> (<span class="id" title="var">tr_abs</span>) "[absI %RF]".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#fupd_mask_subseteq"><span class="id" title="lemma">fupd_mask_subseteq</span></a> <span class="id" title="var">E</span>) <span class="id" title="keyword">as</span> "CC". { <span class="id" title="var">solve_ndisj</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "SI"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">STEP</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">efs</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">[]</span> <span class="id" title="notation">∧</span> <span class="id" title="notation">∃</span> <a id="oe:97" class="idref" href="#oe:97"><span class="id" title="binder"><span id="oe:98" class="id">oe</span></span></a><span class="id" title="notation">,</span> <span class="id" title="var">κ</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">[</span><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#oe:97"><span class="id" title="variable">oe</span></a><span class="id" title="notation">]</span> <span class="id" title="notation">∧</span> σ2<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#:::x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">tr_p</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="notation">[</span><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#oe:97"><span class="id" title="variable">oe</span></a><span class="id" title="notation">]</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [-&gt; [[<span class="id" title="var">oe</span> <span class="id" title="var">os</span>] [-&gt; <span class="id" title="var">Eqtrp</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>-<span class="id" title="var">STEP</span>. <span class="id" title="tactic">destruct</span> σ2. <span class="id" title="tactic">inversion</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">naive_solver</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">oe</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ev</span>|]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;TAU&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">$!</span></a> <span class="id" title="notation">()</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">with</span></a> "[//]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "[? WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[%//]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> (?) "&gt;WP". <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; !&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#step_fupdN_wand"><span class="id" title="lemma">step_fupdN_wand</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "WP"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[//]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "(? &amp; $ &amp; WP &amp; WPs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eqtrp</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_monad.html#fmap_app"><span class="id" title="lemma">fmap_app</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "CC" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;". <span class="id" title="var">iSplitL</span> "absI".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span> "absI".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">clear</span> -<span class="id" title="var">RF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_app"><span class="id" title="lemma">filter_app</span></a> (<span class="id" title="var">_</span> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.option.html#is_Some"><span class="id" title="definition">is_Some</span></a> <span class="id" title="notation">[</span><span class="id" title="var">_</span><span class="id" title="notation">]</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">[]</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">list.list_filter_empty_iff</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "WP"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "absI" <span class="id" title="keyword">as</span> (<span class="id" title="var">ss</span>) "(aF &amp; %INS &amp; %s_init &amp; %INIT &amp; %REACH)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="bluerock.iris.extra.wp_io.lang.html#Compose.is_input"><span class="id" title="projection">Compose.is_input</span></a> <span class="id" title="var">ev</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Eqin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;INPUT&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.mk_committer"><span class="id" title="lemma">mk_committer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "aF"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "aF".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[aF]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "[? WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">instantiate</span> (1:=<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#eee72c44b49c12094ee2f8f5b9bffa39"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#eee72c44b49c12094ee2f8f5b9bffa39"><span class="id" title="notation">tele_arg</span></a> <span class="id" title="var">_</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#eee72c44b49c12094ee2f8f5b9bffa39"><span class="id" title="notation">]</span></a>). <span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span> /= /<a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absE"><span class="id" title="variable">absE</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExact</span> "aF". }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[%//]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> (?)"[? &gt;WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; !&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#step_fupdN_wand"><span class="id" title="lemma">step_fupdN_wand</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "WP"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[//]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "(Post &amp; $ &amp; WP &amp; WPs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Post" <span class="id" title="keyword">as</span> (<span class="id" title="var">ae</span> <span class="id" title="var">Rae</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> [<span class="id" title="var">Ins</span> <span class="id" title="var">aeSTEP</span>]) "aF".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "CC" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eqtrp</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_monad.html#fmap_app"><span class="id" title="lemma">fmap_app</span></a> /=.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;". <span class="id" title="var">iSplitL</span> "aF".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> (<span class="id" title="var">tr_abs</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="notation">[</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">ae</span><span class="id" title="notation">]</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#bb8184054cdbc2cb76438a0b028fc3e8"><span class="id" title="notation">{[</span></a><span class="id" title="var">s'</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#bb8184054cdbc2cb76438a0b028fc3e8"><span class="id" title="notation">]}</span></a>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.auth_exact"><span class="id" title="definition">AuthSet.auth_exact</span></a>. <span class="id" title="var">iFrame</span> "aF".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span>. <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">s_init</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? &lt;-%<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#elem_of_singleton"><span class="id" title="method">elem_of_singleton</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_app"><span class="id" title="lemma">filter_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall2_app</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Rae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_cons_True"><span class="id" title="lemma">filter_cons_True</span></a>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_nil"><span class="id" title="lemma">filter_nil</span></a>. <span class="id" title="tactic">constructor</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "WP"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;OUTPUT&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "[? WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">instantiate</span> (1:= <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#eee72c44b49c12094ee2f8f5b9bffa39"><span class="id" title="notation">[</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#eee72c44b49c12094ee2f8f5b9bffa39"><span class="id" title="notation">tele_arg</span></a> (<span class="id" title="notation">λ</span> <span class="id" title="var">_</span><span class="id" title="notation">,</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'emp'"><span class="id" title="notation">emp</span></a>)%<span class="id" title="var">I</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.telescopes.html#eee72c44b49c12094ee2f8f5b9bffa39"><span class="id" title="notation">]</span></a>). <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "[%//]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">Q</span>) "[AC &gt;WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; !&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.updates.html#step_fupdN_wand"><span class="id" title="lemma">step_fupdN_wand</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "WP"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "AC" <span class="id" title="keyword">as</span> (<span class="id" title="var">ae</span> <span class="id" title="var">Rae</span>) "AC".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "AC" <span class="id" title="keyword">as</span> (<span class="id" title="var">s</span>) "([sF %Ine] &amp; Close)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.frag_exact_auth_sub"><span class="id" title="instance">AuthSet.frag_exact_auth_sub</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "sF aF"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> %<span class="id" title="var">Inss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ine</span> <span class="id" title="var">ae</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s'</span> <span class="id" title="var">STEPs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#elem_of_PropSet"><span class="id" title="lemma">elem_of_PropSet</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">ss'</span> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">{[</span></a> <a id="s':99" class="idref" href="#s':99"><span class="id" title="binder"><span id="s':100" class="id"><span id="s':101" class="id"><span id="s':102" class="id"><span id="s':103" class="id"><span id="s':104" class="id">s'</span></span></span></span></span></span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">|</span></a> <span class="id" title="abbreviation">lts_step</span> (<a class="idref" href="bluerock.iris.extra.base_logic.lib.spectra.html#App.lts"><span class="id" title="method">App.lts</span></a> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.absA"><span class="id" title="variable">absA</span></a>) <span class="id" title="var">s</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">ae</span>) <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#s':99"><span class="id" title="variable">s'</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#9ca50c1ca5bed9ed3d04e2842e7d7905"><span class="id" title="notation">]}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="bluerock.iris.extra.base_logic.lib.auth_set.html#AuthSet.frag_auth_upd"><span class="id" title="lemma">AuthSet.frag_auth_upd</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ss'</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "sF aF"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "[sF aF]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">(</span></a>"Close" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">$!</span></a> <span class="id" title="var">ae</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">with</span></a> "[$sF]"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#e0200f70855f988886fbc8c4fdcdb53d"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "Q".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">clear</span>. <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"WP" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "Q"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">as</span> "(? &amp; sI &amp; WP &amp; WPs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "CC" <span class="id" title="keyword">as</span> "_".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;". <span class="id" title="var">iSplitL</span> "aF sI".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iFrame</span> "sI". <span class="id" title="var">iExists</span> (<span class="id" title="var">tr_abs</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="notation">[(</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">ae</span><span class="id" title="notation">)]</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> <span class="id" title="var">ss'</span>. <span class="id" title="var">iFrame</span> "aF". <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">s'</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#elem_of_PropSet"><span class="id" title="lemma">elem_of_PropSet</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">s_init</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ?. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.propset.html#elem_of_PropSet"><span class="id" title="lemma">elem_of_PropSet</span></a>. <span class="id" title="tactic">intros</span> ?. <span class="id" title="tactic">by</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eqtrp</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_monad.html#fmap_app"><span class="id" title="lemma">fmap_app</span></a> 2!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_app"><span class="id" title="lemma">filter_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall2_app</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Rae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_cons_True"><span class="id" title="lemma">filter_cons_True</span></a>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.list_basics.html#filter_nil"><span class="id" title="lemma">filter_nil</span></a>. <span class="id" title="tactic">constructor</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a>"IH" <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "WP"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io.with_embed"><span class="id" title="section">with_embed</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;fix&nbsp;masks&nbsp;with&nbsp;<span class="inlinecode"><span class="id" title="var">root_inv_committer</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;Section&nbsp;with_inv.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;`{!BiBUpdFUpd&nbsp;PROP}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;`{!HasUsualOwn&nbsp;PROP&nbsp;(mono_list.traceR&nbsp;(option&nbsp;&nbsp;Tr']".&nbsp;{&nbsp;by&nbsp;eexists.&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iMod&nbsp;("CloseI"&nbsp;with&nbsp;"<span class="inlinecode">-</span>")&nbsp;as&nbsp;"_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;iNext.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iDestruct&nbsp;"INS"&nbsp;as&nbsp;(s_init&nbsp;&amp;&nbsp;INIT&nbsp;&amp;&nbsp;REACH).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iDestruct&nbsp;"RF"&nbsp;as&nbsp;elem_of_singleton.&nbsp;by&nbsp;econstructor;&nbsp;eauto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;iPureIntro.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;2!filter_app.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;Forall2_app;&nbsp;<span class="inlinecode"><span class="id" title="var">done</span>|</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;2&nbsp;(rewrite&nbsp;filter_cons_True;&nbsp;last&nbsp;done).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;2!filter_nil.&nbsp;constructor;&nbsp;<span class="inlinecode">|<span class="id" title="var">done</span></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;constructor.&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;:&nbsp;not&nbsp;handling&nbsp;non-stuckness&nbsp;yet.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;Lemma&nbsp;wp_io_run_inv&nbsp;γ_con&nbsp;γ_abs&nbsp;E&nbsp;e&nbsp;Φ&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root_inv&nbsp;γ_con&nbsp;γ_abs&nbsp;⊢<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_io&nbsp;absA&nbsp;R&nbsp;γ_abs&nbsp;MaybeStuck&nbsp;E&nbsp;e&nbsp;Φ&nbsp;-∗<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_inv&nbsp;γ_con&nbsp;MaybeStuck&nbsp;top&nbsp;e&nbsp;Φ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Proof&nbsp;using&nbsp;All.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iIntros&nbsp;"INV WP".
      iLöb as "IH" forall (e).
      rewrite {2}/wp_inv {2}/wp_io.
      rewrite wp_unfold weakestpre.wp_unfold.
      rewrite /weakestpre.wp_pre /wp_pre.
      case_match. { by iMod "WP" as "$". }
      iIntros ([tr_p σ1] ns κ κs nt) "[ha1 SI]".

      iMod (fupd_mask_subseteq E) as "CC". { solve_ndisj. }
      iMod ("WP" with "SI") as "WP".
      iIntros "!>".
      iSplitR; [done|].
      iIntros (e2 σ2 efs STEP).

      assert (efs = [] ∧ ∃ oe, κ = [oe] ∧ σ2.1 = tr_p ++ [oe])
        as [-> [[oe os] [-> Eqtrp]]].
      { clear-STEP. destruct σ2. inversion STEP. naive_solver. }

      destruct oe as [ev|]; last first.
      { (* TAU step *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> ("WP" $! () <span class="id" title="keyword">with</span> "[//]") <span class="id" title="keyword">as</span> "[? WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> ("WP" <span class="id" title="keyword">with</span> "[%//]") <span class="id" title="keyword">as</span> (?) "&gt;WP". <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; !&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<span class="id" title="var">step_fupdN_wand</span> <span class="id" title="keyword">with</span> "WP").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> ("WP" <span class="id" title="keyword">with</span> "[//]") <span class="id" title="keyword">as</span> "(? &amp; $ &amp; WP &amp; WPs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eqtrp</span> <span class="id" title="var">fmap_app</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "CC" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> "INV" <span class="id" title="keyword">as</span> (<span class="id" title="var">tr_con</span>) "[&gt;ha2 RF]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> (<span class="id" title="var">mono_list.half_agree</span> <span class="id" title="keyword">with</span> "ha1 ha2") <span class="id" title="keyword">as</span> %&lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="var">mono_list.half_update</span> <span class="id" title="keyword">with</span> "ha1 ha2") <span class="id" title="keyword">as</span> "[$ ha2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;". <span class="id" title="var">iSplitL</span> "RF ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;make&nbsp;a&nbsp;lemma&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "RF" <span class="id" title="keyword">as</span> (?) "[RF %RF]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">clear</span> -<span class="id" title="var">RF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">filter_app</span> (<span class="id" title="var">_</span> : <span class="id" title="var">filter</span> <span class="id" title="var">is_Some</span> [<span class="id" title="var">_</span>] = []).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">list.list_filter_empty_iff</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> ("IH" <span class="id" title="keyword">with</span> "WP"). }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Compose.is_input</span> <span class="id" title="var">ev</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Eqin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;INPUT&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> (<span class="id" title="var">root_inv_committer</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">with</span> "INV ha1") <span class="id" title="keyword">as</span> "COM".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> ("WP" <span class="id" title="keyword">with</span> "[COM]") <span class="id" title="keyword">as</span> "[? WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">instantiate</span> (1:=[<span class="id" title="var">tele_arg</span> (<span class="id" title="var">_</span>)]). <span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span> /=. <span class="id" title="var">iExact</span> "COM". }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> ("WP" <span class="id" title="keyword">with</span> "[%//]") <span class="id" title="keyword">as</span> (?)"[? &gt;WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; !&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<span class="id" title="var">step_fupdN_wand</span> <span class="id" title="keyword">with</span> "WP").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> ("WP" <span class="id" title="keyword">with</span> "[//]") <span class="id" title="keyword">as</span> (?) "(Post &amp; $ &amp; WP &amp; WPs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span> <span class="id" title="var">Eqtrp</span> <span class="id" title="var">fmap_app</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "CC" <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "Post" <span class="id" title="keyword">as</span> (<span class="id" title="var">ae</span> <span class="id" title="var">Rae</span>) "$".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> ("IH" <span class="id" title="keyword">with</span> "WP").<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;OUTPUT&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> ("WP" <span class="id" title="keyword">with</span> "[]") <span class="id" title="keyword">as</span> "[? WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">instantiate</span> (1:= [<span class="id" title="var">tele_arg</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span>, <span class="id" title="var">emp</span>)%<span class="id" title="var">I</span>]). <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> ("WP" <span class="id" title="keyword">with</span> "[%//]") <span class="id" title="keyword">as</span> (?) "[AC &gt;WP]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; !&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<span class="id" title="var">step_fupdN_wand</span> <span class="id" title="keyword">with</span> "WP").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "WP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> ("WP" <span class="id" title="keyword">with</span> "[//]") <span class="id" title="keyword">as</span> (?) "(? &amp; $ &amp; WP &amp; WPs)". <span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">Eqin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "CC" <span class="id" title="keyword">as</span> "_".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eqtrp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> "INV" <span class="id" title="keyword">as</span> (<span class="id" title="var">tr_con</span>) "[&gt;ha2 RF]" "CloseI".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> (<span class="id" title="var">mono_list.half_agree</span> <span class="id" title="keyword">with</span> "ha1 ha2") <span class="id" title="keyword">as</span> %&lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="var">mono_list.half_update</span> <span class="id" title="keyword">with</span> "ha1 ha2") <span class="id" title="keyword">as</span> "[$ ha2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fmap_app</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "RF" <span class="id" title="keyword">as</span> (<span class="id" title="var">tr_abs</span>) "[RF FRF]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "RF" <span class="id" title="keyword">as</span> (<span class="id" title="var">ss</span>) "(&gt;aF &amp; REACH)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "AC" <span class="id" title="keyword">as</span> (<span class="id" title="var">ae</span> <span class="id" title="var">Rae</span>) "AC".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "AC" <span class="id" title="keyword">as</span> (<span class="id" title="var">s</span>) "([sF %Ine] &amp; Close)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> (<span class="id" title="var">AuthSet.frag_exact_auth_sub</span> <span class="id" title="keyword">with</span> "sF aF") <span class="id" title="keyword">as</span> %<span class="id" title="var">Inss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ine</span> <span class="id" title="var">ae</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s'</span> <span class="id" title="var">STEPs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">elem_of_PropSet</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> (). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">ss'</span> := {[ <span class="id" title="var">s'</span> | <span class="id" title="var">lts_step</span> (<span class="id" title="var">App.lts</span> <span class="id" title="var">absA</span>) <span class="id" title="var">s</span> (<span class="id" title="var">Some</span> <span class="id" title="var">ae</span>) <span class="id" title="var">s'</span> ]}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="var">AuthSet.frag_auth_upd</span> <span class="id" title="var">_</span> <span class="id" title="var">ss'</span> <span class="id" title="keyword">with</span> "sF aF") <span class="id" title="keyword">as</span> "[sF aF]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> ("Close" $! <span class="id" title="var">ae</span> <span class="id" title="keyword">with</span> "[$sF]") <span class="id" title="keyword">as</span> "?".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">clear</span>. <span class="id" title="var">set_solver</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> ("CloseI" <span class="id" title="keyword">with</span> "[aF ha2 REACH FRF]") <span class="id" title="keyword">as</span> "?".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> (<span class="id" title="var">tr_abs</span> ++ [(<span class="id" title="var">Some</span> <span class="id" title="var">ae</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "REACH" <span class="id" title="keyword">as</span> %(<span class="id" title="var">INS</span> &amp; <span class="id" title="var">s_init</span> &amp; <span class="id" title="var">INIT</span> &amp; <span class="id" title="var">REACH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "FRF" <span class="id" title="keyword">as</span> %<span class="id" title="var">RF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> <span class="id" title="var">ss'</span>. <span class="id" title="var">iFrame</span> "aF". <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">s'</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">elem_of_PropSet</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">s_init</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ?. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">elem_of_PropSet</span>. <span class="id" title="tactic">intros</span> ?. <span class="id" title="tactic">by</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">fmap_app</span> 2!<span class="id" title="var">filter_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2_app</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Rae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">filter_cons_True</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">filter_nil</span>. <span class="id" title="tactic">constructor</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt;".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> ("IH" <span class="id" title="keyword">with</span> "WP").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">with_inv</span>.<br/>
*)<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bluerock.iris.extra.wp_io.refinement.wp_io.html#root_aux_1.root.wp_io"><span class="id" title="section">wp_io</span></a>.<br/>

<br/>
<span class="id" title="var">NES.End</span> <span class="id" title="var">root</span>.<br/>
</div>
<!--
-- Copyright (c) 2020 BlueRock Security, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
